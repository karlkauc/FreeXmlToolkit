<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.web.WebView?>
<?import org.kordamp.ikonli.javafx.*?>
<VBox prefHeight="768.0" prefWidth="1024.0" AnchorPane.bottomAnchor="0" AnchorPane.leftAnchor="0"
      AnchorPane.rightAnchor="0" AnchorPane.topAnchor="0" xmlns="http://javafx.com/javafx/11.0.14-internal"
      xmlns:fx="http://javafx.com/fxml/1" fx:controller="org.fxt.freexmltoolkit.controller.SchematronController">

    <!-- Main Tab Container -->
    <TabPane fx:id="tabPane" VBox.vgrow="ALWAYS">

        <!-- Welcome/Overview Tab -->
        <Tab fx:id="overviewTab" text="Overview" closable="false">
            <graphic>
                <FontIcon iconLiteral="bi-info-circle" iconColor="#007bff" iconSize="16"/>
            </graphic>
            <ScrollPane fitToWidth="true" fitToHeight="true">
                <VBox spacing="15" style="-fx-padding: 20;">

                    <!-- Header -->
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <FontIcon iconLiteral="bi-shield-check" iconColor="#ff6b6b" iconSize="32"/>
                        <VBox spacing="5">
                            <Label text="Schematron Validator" style="-fx-font-size: 18px; -fx-font-weight: bold;"/>
                            <Label text="Business Rules and Validation for XML Documents"
                                   style="-fx-text-fill: #6c757d;"/>
                        </VBox>
                    </HBox>

                    <Separator/>

                    <!-- What is Schematron -->
                    <VBox spacing="10">
                        <Label text="What is Schematron?" style="-fx-font-size: 14px; -fx-font-weight: bold;"/>
                        <Label text="Schematron is a rule-based validation system for XML documents. It enables the definition of business rules and integrity constraints that go beyond the capabilities of XML Schema (XSD)."
                               wrapText="true" style="-fx-text-fill: #495057;"/>
                    </VBox>

                    <!-- Features Grid -->
                    <GridPane hgap="20" vgap="15">
                        <columnConstraints>
                            <ColumnConstraints hgrow="SOMETIMES" minWidth="10.0" prefWidth="50.0"/>
                            <ColumnConstraints hgrow="SOMETIMES" minWidth="10.0" prefWidth="50.0"/>
                        </columnConstraints>

                        <!-- Feature 1 -->
                        <VBox spacing="8" GridPane.columnIndex="0" GridPane.rowIndex="0">
                            <HBox alignment="CENTER_LEFT" spacing="8">
                                <FontIcon iconLiteral="bi-code-slash" iconColor="#28a745" iconSize="20"/>
                                <Label text="Code Editor" style="-fx-font-weight: bold;"/>
                            </HBox>
                            <Label text="Create and edit Schematron rules with syntax highlighting and auto-completion"
                                   wrapText="true" style="-fx-text-fill: #6c757d; -fx-font-size: 12px;"/>
                        </VBox>

                        <!-- Feature 2 -->
                        <VBox spacing="8" GridPane.columnIndex="1" GridPane.rowIndex="0">
                            <HBox alignment="CENTER_LEFT" spacing="8">
                                <FontIcon iconLiteral="bi-diagram-3" iconColor="dodgerblue" iconSize="20"/>
                                <Label text="Visual Builder" style="-fx-font-weight: bold;"/>
                            </HBox>
                            <Label text="Create rules visually without XML knowledge using a user-friendly interface"
                                   wrapText="true" style="-fx-text-fill: #6c757d; -fx-font-size: 12px;"/>
                        </VBox>

                        <!-- Feature 3 -->
                        <VBox spacing="8" GridPane.columnIndex="0" GridPane.rowIndex="1">
                            <HBox alignment="CENTER_LEFT" spacing="8">
                                <FontIcon iconLiteral="bi-play-circle" iconColor="#ff6b6b" iconSize="20"/>
                                <Label text="Testing" style="-fx-font-weight: bold;"/>
                            </HBox>
                            <Label text="Validate XML documents against your Schematron rules and see detailed results"
                                   wrapText="true" style="-fx-text-fill: #6c757d; -fx-font-size: 12px;"/>
                        </VBox>

                        <!-- Feature 4 -->
                        <VBox spacing="8" GridPane.columnIndex="1" GridPane.rowIndex="1">
                            <HBox alignment="CENTER_LEFT" spacing="8">
                                <FontIcon iconLiteral="bi-book" iconColor="#16a34a" iconSize="20"/>
                                <Label text="Documentation" style="-fx-font-weight: bold;"/>
                            </HBox>
                            <Label text="Automatically generate documentation for your Schematron rules and validation logic"
                                   wrapText="true" style="-fx-text-fill: #6c757d; -fx-font-size: 12px;"/>
                        </VBox>
                    </GridPane>

                    <Separator/>

                    <!-- Getting Started -->
                    <VBox spacing="10">
                        <Label text="Getting Started:" style="-fx-font-size: 14px; -fx-font-weight: bold;"/>
                        <VBox spacing="8">
                            <HBox alignment="CENTER_LEFT" spacing="8">
                                <Label text="1." style="-fx-font-weight: bold; -fx-text-fill: #007bff;"/>
                                <Label text="Go to the 'Code' tab to create a new Schematron schema or load an existing one"
                                       wrapText="true"/>
                            </HBox>
                            <HBox alignment="CENTER_LEFT" spacing="8">
                                <Label text="2." style="-fx-font-weight: bold; -fx-text-fill: #007bff;"/>
                                <Label text="Use the 'New Rule' and 'New Pattern' buttons to add validation rules"
                                       wrapText="true"/>
                            </HBox>
                            <HBox alignment="CENTER_LEFT" spacing="8">
                                <Label text="3." style="-fx-font-weight: bold; -fx-text-fill: #007bff;"/>
                                <Label text="Test your rules in the 'Test' tab with sample XML documents"
                                       wrapText="true"/>
                            </HBox>
                            <HBox alignment="CENTER_LEFT" spacing="8">
                                <Label text="4." style="-fx-font-weight: bold; -fx-text-fill: #007bff;"/>
                                <Label text="Generate documentation for your schema in the 'Documentation' tab"
                                       wrapText="true"/>
                            </HBox>
                        </VBox>
                    </VBox>

                    <!-- Quick Actions -->
                    <VBox spacing="10">
                        <Label text="Quick Actions:" style="-fx-font-size: 14px; -fx-font-weight: bold;"/>
                        <HBox spacing="10">
                            <Button text="Create New Schema">
                                <graphic>
                                    <FontIcon iconLiteral="bi-plus-circle" iconColor="#28a745" iconSize="14"/>
                                </graphic>
                            </Button>
                            <Button text="Load Schema">
                                <graphic>
                                    <FontIcon iconLiteral="bi-folder2-open" iconSize="14"/>
                                </graphic>
                            </Button>
                            <Button text="Show Examples">
                                <graphic>
                                    <FontIcon iconLiteral="bi-lightbulb" iconColor="#ffc107" iconSize="14"/>
                                </graphic>
                            </Button>
                        </HBox>
                    </VBox>

                </VBox>
            </ScrollPane>
        </Tab>

        <!-- Code Editor Tab -->
        <Tab fx:id="codeTab" text="Code" closable="false">
            <graphic>
                <FontIcon iconLiteral="bi-code-slash" iconSize="16"/>
            </graphic>
            <VBox spacing="0">
                <!-- Toolbar -->
                <ToolBar fx:id="toolbar">
                    <Button fx:id="newRuleButton" text="New Rule">
                        <graphic>
                            <FontIcon iconLiteral="bi-plus-circle" iconColor="#28a745" iconSize="14"/>
                        </graphic>
                        <tooltip>
                            <Tooltip text="Insert a new rule template"/>
                        </tooltip>
                    </Button>

                    <Button fx:id="newPatternButton" text="New Pattern">
                        <graphic>
                            <FontIcon iconLiteral="bi-collection" iconColor="#007bff" iconSize="14"/>
                        </graphic>
                        <tooltip>
                            <Tooltip text="Insert a new pattern template"/>
                        </tooltip>
                    </Button>

                    <Separator orientation="VERTICAL"/>

                    <Button fx:id="validateButton" text="Validate">
                        <graphic>
                            <FontIcon iconLiteral="bi-check-circle" iconColor="#17a2b8" iconSize="14"/>
                        </graphic>
                        <tooltip>
                            <Tooltip text="Validate Schematron syntax"/>
                        </tooltip>
                    </Button>

                    <Button fx:id="testRulesButton" text="Test Rules">
                        <graphic>
                            <FontIcon iconLiteral="bi-play-circle" iconColor="#ff6b6b" iconSize="14"/>
                        </graphic>
                        <tooltip>
                            <Tooltip text="Test rules against XML files"/>
                        </tooltip>
                    </Button>

                    <Separator orientation="VERTICAL"/>

                    <!-- Favorites Buttons -->
                    <Button fx:id="addSchematronToFavoritesButton" text="★ Add"
                            onAction="#addCurrentSchematronToFavorites">
                        <graphic>
                            <FontIcon iconLiteral="bi-star" iconColor="#ffc107" iconSize="14"/>
                        </graphic>
                        <tooltip>
                            <Tooltip text="Add current Schematron file to favorites"/>
                        </tooltip>
                    </Button>

                    <MenuButton fx:id="loadSchematronFavoritesButton" text="Favorites">
                        <graphic>
                            <FontIcon iconLiteral="bi-star-fill" iconColor="#ffc107" iconSize="14"/>
                        </graphic>
                        <tooltip>
                            <Tooltip text="Load from favorites"/>
                        </tooltip>
                    </MenuButton>
                </ToolBar>

                <!-- Main Content Area with Split Pane -->
                <SplitPane dividerPositions="0.75" VBox.vgrow="ALWAYS">

                    <!-- Main Editor Area -->
                    <VBox fx:id="codeEditorContainer" spacing="0" SplitPane.resizableWithParent="true">
                        <!-- Code editor will be added programmatically -->
                    </VBox>

                    <!-- Sidebar -->
                    <VBox fx:id="sidebarContainer" spacing="5" minWidth="200" maxWidth="400" prefWidth="300">
                        <padding>
                            <Insets top="5" right="5" bottom="5" left="5"/>
                        </padding>

                        <!-- Quick Help -->
                        <TitledPane fx:id="helpPane" text="Quick Help" expanded="true" collapsible="true">
                            <VBox spacing="8" style="-fx-padding: 5;">
                                <Label text="Schematron Basics:"
                                       style="-fx-font-weight: bold; -fx-font-size: 12px;"/>
                                <VBox spacing="5">
                                    <Label text="• &lt;pattern&gt; - Groups related rules together"
                                           style="-fx-font-size: 11px;" wrapText="true"/>
                                    <Label text="• &lt;rule&gt; - Defines context and conditions"
                                           style="-fx-font-size: 11px;" wrapText="true"/>
                                    <Label text="• &lt;assert&gt; - Tests a condition (must be true)"
                                           style="-fx-font-size: 11px;" wrapText="true"/>
                                    <Label text="• &lt;report&gt; - Reports a finding (when condition is true)"
                                           style="-fx-font-size: 11px;" wrapText="true"/>
                                </VBox>

                                <Separator/>

                                <Label text="Common XPath Expressions:"
                                       style="-fx-font-weight: bold; -fx-font-size: 12px;"/>
                                <VBox spacing="5">
                                    <Label text="• . - Current node" style="-fx-font-size: 11px;"/>
                                    <Label text="• @attribute - Attribute of current node"
                                           style="-fx-font-size: 11px;"/>
                                    <Label text="• child::element - Child element" style="-fx-font-size: 11px;"/>
                                    <Label text="• count(element) - Count elements" style="-fx-font-size: 11px;"/>
                                    <Label text="• string-length(.) &gt; 0 - Text present"
                                           style="-fx-font-size: 11px;"/>
                                </VBox>
                            </VBox>
                        </TitledPane>

                        <!-- Schematron Structure -->
                        <TitledPane fx:id="structurePane" text="Document Structure" expanded="true" collapsible="true">
                            <VBox spacing="5">
                                <Label text="Structure of current schema:" style="-fx-font-size: 11px;"/>
                                <ListView prefHeight="100">
                                    <placeholder>
                                        <VBox alignment="CENTER" spacing="5">
                                            <FontIcon iconLiteral="bi-file-earmark-code" iconColor="#ced4da"
                                                      iconSize="24"/>
                                            <Label text="No schema loaded yet"
                                                   style="-fx-text-fill: #6c757d; -fx-font-size: 11px;"/>
                                        </VBox>
                                    </placeholder>
                                </ListView>
                            </VBox>
                        </TitledPane>

                        <!-- Rule Templates -->
                        <TitledPane fx:id="templatesPane" text="Rule Templates" expanded="false" collapsible="true">
                            <VBox spacing="8" style="-fx-padding: 5;">
                                <Label text="Frequently used rules:"
                                       style="-fx-font-weight: bold; -fx-font-size: 11px;"/>

                                <!-- Template Buttons -->
                                <VBox spacing="5">
                                    <Button text="Required Field Rule" style="-fx-font-size: 10px;" maxWidth="Infinity">
                                        <graphic>
                                            <FontIcon iconLiteral="bi-asterisk" iconColor="#dc3545" iconSize="10"/>
                                        </graphic>
                                        <tooltip>
                                            <Tooltip text="Insert rule for required fields"/>
                                        </tooltip>
                                    </Button>

                                    <Button text="Format Validation" style="-fx-font-size: 10px;" maxWidth="Infinity">
                                        <graphic>
                                            <FontIcon iconLiteral="bi-search" iconColor="#007bff" iconSize="10"/>
                                        </graphic>
                                        <tooltip>
                                            <Tooltip text="Insert rule for format validation (Email, Date, etc.)"/>
                                        </tooltip>
                                    </Button>

                                    <Button text="Dependency Rule" style="-fx-font-size: 10px;" maxWidth="Infinity">
                                        <graphic>
                                            <FontIcon iconLiteral="bi-link" iconColor="#28a745" iconSize="10"/>
                                        </graphic>
                                        <tooltip>
                                            <Tooltip text="Insert rule for conditional dependencies"/>
                                        </tooltip>
                                    </Button>

                                    <Button text="Range Check" style="-fx-font-size: 10px;" maxWidth="Infinity">
                                        <graphic>
                                            <FontIcon iconLiteral="bi-bar-chart" iconColor="#ffc107" iconSize="10"/>
                                        </graphic>
                                        <tooltip>
                                            <Tooltip text="Insert rule for value range checking"/>
                                        </tooltip>
                                    </Button>
                                </VBox>
                            </VBox>
                        </TitledPane>

                        <!-- XPath Helper -->
                        <TitledPane fx:id="xpathHelperPane" text="XPath Tester" expanded="false" collapsible="true"
                                    VBox.vgrow="ALWAYS">
                            <VBox spacing="8" style="-fx-padding: 5;">
                                <Label text="Test XPath Expression:"
                                       style="-fx-font-weight: bold; -fx-font-size: 11px;"/>
                                <TextField promptText="Enter an XPath expression..."
                                           style="-fx-font-size: 11px;"/>
                                <Button text="Test" style="-fx-font-size: 10px;">
                                    <graphic>
                                        <FontIcon iconLiteral="bi-play" iconSize="10"/>
                                    </graphic>
                                </Button>

                                <Label text="Result:" style="-fx-font-weight: bold; -fx-font-size: 11px;"/>
                                <TextArea prefRowCount="3" editable="false" style="-fx-font-size: 10px;"
                                          promptText="XPath result will be displayed here..."/>

                                <Separator/>

                                <Label text="XPath Functions:" style="-fx-font-weight: bold; -fx-font-size: 11px;"/>
                                <ListView prefHeight="80" style="-fx-font-size: 10px;">
                                    <placeholder>
                                        <VBox alignment="CENTER" spacing="5">
                                            <Label text="count() - Count elements" style="-fx-font-size: 10px;"/>
                                            <Label text="string-length() - Text length" style="-fx-font-size: 10px;"/>
                                            <Label text="contains() - Text contains" style="-fx-font-size: 10px;"/>
                                            <Label text="starts-with() - Text starts with"
                                                   style="-fx-font-size: 10px;"/>
                                            <Label text="normalize-space() - Normalize whitespace"
                                                   style="-fx-font-size: 10px;"/>
                                        </VBox>
                                    </placeholder>
                                </ListView>
                            </VBox>
                        </TitledPane>

                    </VBox>

                </SplitPane>
            </VBox>
        </Tab>

        <!-- Visual Builder Tab -->
        <Tab fx:id="visualBuilderTab" text="Visual Builder" closable="false">
            <graphic>
                <FontIcon iconLiteral="bi-diagram-3" iconColor="dodgerblue" iconSize="16"/>
            </graphic>
            <ScrollPane fitToWidth="true" fitToHeight="true">
                <VBox fx:id="visualBuilderContainer" spacing="15" style="-fx-padding: 20;">

                    <!-- Header -->
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <FontIcon iconLiteral="bi-diagram-3" iconColor="dodgerblue" iconSize="32"/>
                        <VBox spacing="5">
                            <Label text="Visual Builder" style="-fx-font-size: 18px; -fx-font-weight: bold;"/>
                            <Label text="Create Schematron rules without XML knowledge"
                                   style="-fx-text-fill: #6c757d;"/>
                        </VBox>
                    </HBox>

                    <Separator/>

                    <!-- Instructions -->
                    <VBox spacing="10">
                        <Label text="How the Visual Builder works:"
                               style="-fx-font-size: 14px; -fx-font-weight: bold;"/>
                        <VBox spacing="8">
                            <HBox alignment="CENTER_LEFT" spacing="8">
                                <FontIcon iconLiteral="bi-arrow-right-circle" iconColor="#007bff" iconSize="16"/>
                                <Label text="Select the XML node for which you want to create a rule"
                                       wrapText="true"/>
                            </HBox>
                            <HBox alignment="CENTER_LEFT" spacing="8">
                                <FontIcon iconLiteral="bi-arrow-down-circle" iconColor="#007bff" iconSize="16"/>
                                <Label text="Define the condition using simple dropdown menus"
                                       wrapText="true"/>
                            </HBox>
                            <HBox alignment="CENTER_LEFT" spacing="8">
                                <FontIcon iconLiteral="bi-exclamation-circle" iconColor="#007bff" iconSize="16"/>
                                <Label text="Enter a clear error message" wrapText="true"/>
                            </HBox>
                            <HBox alignment="CENTER_LEFT" spacing="8">
                                <FontIcon iconLiteral="bi-check-circle" iconColor="#007bff" iconSize="16"/>
                                <Label text="The corresponding XML rule is automatically generated" wrapText="true"/>
                            </HBox>
                        </VBox>
                    </VBox>

                    <!-- Rule Builder Interface -->
                    <VBox spacing="15" style="-fx-border-color: #dee2e6; -fx-border-radius: 5; -fx-padding: 15;">
                        <Label text="Create New Rule:" style="-fx-font-size: 16px; -fx-font-weight: bold;"/>

                        <!-- Step 1: Select Context -->
                        <VBox spacing="8">
                            <HBox alignment="CENTER_LEFT" spacing="8">
                                <FontIcon iconLiteral="bi-arrow-right-circle-fill" iconColor="#007bff" iconSize="16"/>
                                <Label text="Select XML Element/Context:" style="-fx-font-weight: bold;"/>
                            </HBox>
                            <HBox spacing="10" alignment="CENTER_LEFT">
                                <Label text="Apply rule to:" minWidth="120"/>
                                <TextField promptText="e.g. //invoice/customer" prefWidth="200"
                                           style="-fx-font-size: 12px;"/>
                                <Button text="Select Element">
                                    <graphic>
                                        <FontIcon iconLiteral="bi-search" iconSize="12"/>
                                    </graphic>
                                </Button>
                            </HBox>
                        </VBox>

                        <!-- Step 2: Define Condition -->
                        <VBox spacing="8">
                            <HBox alignment="CENTER_LEFT" spacing="8">
                                <FontIcon iconLiteral="bi-arrow-down-circle-fill" iconColor="#007bff" iconSize="16"/>
                                <Label text="Define Condition:" style="-fx-font-weight: bold;"/>
                            </HBox>
                            <HBox spacing="10" alignment="CENTER_LEFT">
                                <ComboBox promptText="Select rule type..." prefWidth="150"
                                          style="-fx-font-size: 12px;"/>
                                <ComboBox promptText="Operator..." prefWidth="100" style="-fx-font-size: 12px;"/>
                                <TextField promptText="Enter value..." prefWidth="150" style="-fx-font-size: 12px;"/>
                            </HBox>
                        </VBox>

                        <!-- Step 3: Error Message -->
                        <VBox spacing="8">
                            <HBox alignment="CENTER_LEFT" spacing="8">
                                <FontIcon iconLiteral="bi-exclamation-circle-fill" iconColor="#007bff" iconSize="16"/>
                                <Label text="Error Message:" style="-fx-font-weight: bold;"/>
                            </HBox>
                            <TextArea promptText="Describe what should be displayed when the rule is violated..."
                                      prefRowCount="2" style="-fx-font-size: 12px;"/>
                        </VBox>

                        <!-- Step 4: Rule Type -->
                        <VBox spacing="8">
                            <HBox alignment="CENTER_LEFT" spacing="8">
                                <FontIcon iconLiteral="bi-check-circle-fill" iconColor="#007bff" iconSize="16"/>
                                <Label text="Rule Type:" style="-fx-font-weight: bold;"/>
                            </HBox>
                            <HBox spacing="15">
                                <RadioButton text="Assert (condition must be fulfilled)" selected="true">
                                    <toggleGroup>
                                        <ToggleGroup fx:id="ruleTypeGroup"/>
                                    </toggleGroup>
                                </RadioButton>
                                <RadioButton text="Report (message when condition is fulfilled)"
                                             toggleGroup="$ruleTypeGroup"/>
                            </HBox>
                        </VBox>

                        <!-- Actions -->
                        <HBox spacing="10" alignment="CENTER_LEFT">
                            <Button text="Generate Rule" style="-fx-font-weight: bold;">
                                <graphic>
                                    <FontIcon iconLiteral="bi-gear" iconColor="#28a745" iconSize="14"/>
                                </graphic>
                            </Button>
                            <Button text="Preview">
                                <graphic>
                                    <FontIcon iconLiteral="bi-eye" iconSize="14"/>
                                </graphic>
                            </Button>
                            <Button text="Reset">
                                <graphic>
                                    <FontIcon iconLiteral="bi-arrow-clockwise" iconSize="14"/>
                                </graphic>
                            </Button>
                        </HBox>
                    </VBox>

                    <!-- Generated Rule Preview -->
                    <VBox spacing="10">
                        <Label text="Generated XML Rule:" style="-fx-font-size: 14px; -fx-font-weight: bold;"/>
                        <TextArea editable="false" prefRowCount="6"
                                  style="-fx-font-family: 'Courier New', monospace; -fx-font-size: 11px;"
                                  promptText="The generated Schematron rule will be displayed here..."/>

                        <HBox spacing="10">
                            <Button text="Apply to Code Editor">
                                <graphic>
                                    <FontIcon iconLiteral="bi-arrow-right" iconColor="#007bff" iconSize="14"/>
                                </graphic>
                            </Button>
                            <Button text="Copy Rule">
                                <graphic>
                                    <FontIcon iconLiteral="bi-clipboard" iconSize="14"/>
                                </graphic>
                            </Button>
                        </HBox>
                    </VBox>

                    <!-- Common Patterns -->
                    <VBox spacing="10">
                        <Label text="Common Validation Patterns:" style="-fx-font-size: 14px; -fx-font-weight: bold;"/>
                        <GridPane hgap="10" vgap="10">
                            <columnConstraints>
                                <ColumnConstraints hgrow="SOMETIMES" minWidth="10.0" prefWidth="50.0"/>
                                <ColumnConstraints hgrow="SOMETIMES" minWidth="10.0" prefWidth="50.0"/>
                            </columnConstraints>

                            <Button text="Email Format" GridPane.columnIndex="0" GridPane.rowIndex="0"
                                    maxWidth="Infinity">
                                <graphic>
                                    <FontIcon iconLiteral="bi-envelope" iconSize="12"/>
                                </graphic>
                            </Button>

                            <Button text="Date Format" GridPane.columnIndex="1" GridPane.rowIndex="0"
                                    maxWidth="Infinity">
                                <graphic>
                                    <FontIcon iconLiteral="bi-calendar" iconSize="12"/>
                                </graphic>
                            </Button>

                            <Button text="Number Range" GridPane.columnIndex="0" GridPane.rowIndex="1"
                                    maxWidth="Infinity">
                                <graphic>
                                    <FontIcon iconLiteral="bi-hash" iconSize="12"/>
                                </graphic>
                            </Button>

                            <Button text="Text Length" GridPane.columnIndex="1" GridPane.rowIndex="1"
                                    maxWidth="Infinity">
                                <graphic>
                                    <FontIcon iconLiteral="bi-text-paragraph" iconSize="12"/>
                                </graphic>
                            </Button>
                        </GridPane>
                    </VBox>

                </VBox>
            </ScrollPane>
        </Tab>

        <!-- Test Tab -->
        <Tab fx:id="testTab" text="Test" closable="false">
            <graphic>
                <FontIcon iconLiteral="bi-play-circle" iconColor="#ff6b6b" iconSize="16"/>
            </graphic>
            <ScrollPane fitToWidth="true" fitToHeight="true">
                <VBox fx:id="testingContainer" spacing="15" style="-fx-padding: 20;">

                    <!-- Header -->
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <FontIcon iconLiteral="bi-play-circle" iconColor="#ff6b6b" iconSize="32"/>
                        <VBox spacing="5">
                            <Label text="Schematron Testing" style="-fx-font-size: 18px; -fx-font-weight: bold;"/>
                            <Label text="Test your Schematron rules with XML documents"
                                   style="-fx-text-fill: #6c757d;"/>
                        </VBox>
                    </HBox>

                    <Separator/>

                    <!-- Testing Process -->
                    <VBox spacing="15">
                        <Label text="Test Process:" style="-fx-font-size: 14px; -fx-font-weight: bold;"/>

                        <!-- Step 1: Load Schema -->
                        <HBox spacing="15" style="-fx-border-color: #e9ecef; -fx-border-radius: 5; -fx-padding: 15;">
                            <VBox alignment="CENTER">
                                <FontIcon iconLiteral="bi-arrow-right-circle-fill" iconColor="#28a745" iconSize="24"/>
                            </VBox>
                            <VBox spacing="8" HBox.hgrow="ALWAYS">
                                <Label text="Load Schematron Schema"
                                       style="-fx-font-weight: bold; -fx-font-size: 14px;"/>
                                <Label text="Load your Schematron schema (.sch file) or use the schema from the Code Editor"
                                       wrapText="true" style="-fx-text-fill: #6c757d;"/>
                                <HBox spacing="10">
                                    <Button text="Load Schema from File">
                                        <graphic>
                                            <FontIcon iconLiteral="bi-folder2-open" iconSize="14"/>
                                        </graphic>
                                    </Button>
                                    <Button text="Use Current Schema">
                                        <graphic>
                                            <FontIcon iconLiteral="bi-code-slash" iconSize="14"/>
                                        </graphic>
                                    </Button>
                                </HBox>
                            </VBox>
                        </HBox>

                        <!-- Step 2: Add Test Files -->
                        <HBox spacing="15" style="-fx-border-color: #e9ecef; -fx-border-radius: 5; -fx-padding: 15;">
                            <VBox alignment="CENTER">
                                <FontIcon iconLiteral="bi-arrow-down-circle-fill" iconColor="#ffc107" iconSize="24"/>
                            </VBox>
                            <VBox spacing="8" HBox.hgrow="ALWAYS">
                                <Label text="Add Test XML Files"
                                       style="-fx-font-weight: bold; -fx-font-size: 14px;"/>
                                <Label text="Add XML files that should be tested against your Schematron rules"
                                       wrapText="true" style="-fx-text-fill: #6c757d;"/>
                                <HBox spacing="10">
                                    <Button text="Add XML File">
                                        <graphic>
                                            <FontIcon iconLiteral="bi-file-earmark-plus" iconSize="14"/>
                                        </graphic>
                                    </Button>
                                    <Button text="Add Folder">
                                        <graphic>
                                            <FontIcon iconLiteral="bi-folder-plus" iconSize="14"/>
                                        </graphic>
                                    </Button>
                                    <Button text="Load Sample XMLs">
                                        <graphic>
                                            <FontIcon iconLiteral="bi-lightbulb" iconColor="#ffc107" iconSize="14"/>
                                        </graphic>
                                    </Button>
                                </HBox>
                            </VBox>
                        </HBox>

                        <!-- Step 3: Run Tests -->
                        <HBox spacing="15" style="-fx-border-color: #e9ecef; -fx-border-radius: 5; -fx-padding: 15;">
                            <VBox alignment="CENTER">
                                <FontIcon iconLiteral="bi-exclamation-circle-fill" iconColor="#007bff" iconSize="24"/>
                            </VBox>
                            <VBox spacing="8" HBox.hgrow="ALWAYS">
                                <Label text="Run Tests" style="-fx-font-weight: bold; -fx-font-size: 14px;"/>
                                <Label text="Start validation and see results in real time"
                                       wrapText="true" style="-fx-text-fill: #6c757d;"/>
                                <HBox spacing="10">
                                    <Button text="Run All Tests" style="-fx-font-weight: bold;">
                                        <graphic>
                                            <FontIcon iconLiteral="bi-play-fill" iconColor="#28a745" iconSize="14"/>
                                        </graphic>
                                    </Button>
                                    <Button text="Test Single File">
                                        <graphic>
                                            <FontIcon iconLiteral="bi-play" iconSize="14"/>
                                        </graphic>
                                    </Button>
                                </HBox>
                            </VBox>
                        </HBox>
                    </VBox>

                    <!-- Test Files Section -->
                    <VBox spacing="10">
                        <Label text="Test Files:" style="-fx-font-size: 14px; -fx-font-weight: bold;"/>

                        <TableView prefHeight="200" style="-fx-font-size: 12px;">
                            <placeholder>
                                <VBox alignment="CENTER" spacing="10">
                                    <FontIcon iconLiteral="bi-inbox" iconColor="#ced4da" iconSize="32"/>
                                    <Label text="No test files added" style="-fx-text-fill: #6c757d;"/>
                                    <Button text="Add First XML File">
                                        <graphic>
                                            <FontIcon iconLiteral="bi-plus-circle" iconColor="#28a745" iconSize="14"/>
                                        </graphic>
                                    </Button>
                                </VBox>
                            </placeholder>
                            <columns>
                                <TableColumn text="Filename" prefWidth="200"/>
                                <TableColumn text="Status" prefWidth="100"/>
                                <TableColumn text="Rule Violations" prefWidth="100"/>
                                <TableColumn text="Warnings" prefWidth="100"/>
                                <TableColumn text="Actions" prefWidth="150"/>
                            </columns>
                        </TableView>

                        <HBox spacing="10">
                            <Button text="Add File">
                                <graphic>
                                    <FontIcon iconLiteral="bi-plus-circle" iconSize="14"/>
                                </graphic>
                            </Button>
                            <Button text="Remove Selected">
                                <graphic>
                                    <FontIcon iconLiteral="bi-dash-circle" iconColor="#dc3545" iconSize="14"/>
                                </graphic>
                            </Button>
                            <Button text="Remove All">
                                <graphic>
                                    <FontIcon iconLiteral="bi-trash" iconColor="#dc3545" iconSize="14"/>
                                </graphic>
                            </Button>
                        </HBox>
                    </VBox>

                    <!-- Test Results Section -->
                    <VBox spacing="10">
                        <HBox alignment="CENTER_LEFT" spacing="10">
                            <Label text="Test Results:" style="-fx-font-size: 14px; -fx-font-weight: bold;"/>
                            <Button text="Export Results">
                                <graphic>
                                    <FontIcon iconLiteral="bi-download" iconSize="14"/>
                                </graphic>
                            </Button>
                        </HBox>

                        <TabPane prefHeight="300">
                            <Tab text="Overview" closable="false">
                                <ScrollPane fitToWidth="true" fitToHeight="true">
                                    <VBox spacing="10" style="-fx-padding: 10;">
                                        <!-- Summary will be displayed here -->
                                        <VBox alignment="CENTER" spacing="15">
                                            <FontIcon iconLiteral="bi-graph-up" iconColor="#6c757d" iconSize="48"/>
                                            <Label text="Run tests to see an overview of results"
                                                   style="-fx-text-fill: #6c757d; -fx-font-size: 14px;"/>
                                        </VBox>
                                    </VBox>
                                </ScrollPane>
                            </Tab>

                            <Tab text="Details" closable="false">
                                <ScrollPane fitToWidth="true" fitToHeight="true">
                                    <VBox spacing="10" style="-fx-padding: 10;">
                                        <!-- Detailed results will be displayed here -->
                                        <VBox alignment="CENTER" spacing="15">
                                            <FontIcon iconLiteral="bi-list-ul" iconColor="#6c757d" iconSize="48"/>
                                            <Label text="Detailed validation results will be displayed here"
                                                   style="-fx-text-fill: #6c757d; -fx-font-size: 14px;"/>
                                        </VBox>
                                    </VBox>
                                </ScrollPane>
                            </Tab>

                            <Tab text="Errors" closable="false">
                                <ScrollPane fitToWidth="true" fitToHeight="true">
                                    <VBox spacing="10" style="-fx-padding: 10;">
                                        <!-- Errors will be displayed here -->
                                        <VBox alignment="CENTER" spacing="15">
                                            <FontIcon iconLiteral="bi-exclamation-triangle" iconColor="#6c757d"
                                                      iconSize="48"/>
                                            <Label text="Validation errors and rule violations will be listed here"
                                                   style="-fx-text-fill: #6c757d; -fx-font-size: 14px;"/>
                                        </VBox>
                                    </VBox>
                                </ScrollPane>
                            </Tab>
                        </TabPane>
                    </VBox>

                    <!-- Testing Tips -->
                    <VBox spacing="10"
                          style="-fx-border-color: #d1ecf1; -fx-border-radius: 5; -fx-background-color: #d1ecf1; -fx-padding: 15;">
                        <HBox alignment="CENTER_LEFT" spacing="8">
                            <FontIcon iconLiteral="bi-lightbulb" iconColor="#0c5460" iconSize="20"/>
                            <Label text="Testing Tips:" style="-fx-font-weight: bold; -fx-text-fill: #0c5460;"/>
                        </HBox>
                        <VBox spacing="5">
                            <Label text="• Test both valid and invalid XML documents"
                                   style="-fx-text-fill: #0c5460; -fx-font-size: 12px;"/>
                            <Label text="• Create test cases for every edge case of your business rules"
                                   style="-fx-text-fill: #0c5460; -fx-font-size: 12px;"/>
                            <Label text="• Use meaningful filenames for your test XMLs"
                                   style="-fx-text-fill: #0c5460; -fx-font-size: 12px;"/>
                            <Label text="• Export test results for documentation"
                                   style="-fx-text-fill: #0c5460; -fx-font-size: 12px;"/>
                        </VBox>
                    </VBox>

                </VBox>
            </ScrollPane>
        </Tab>

        <!-- Documentation Tab -->
        <Tab fx:id="documentationTab" text="Documentation" closable="false">
            <graphic>
                <FontIcon iconLiteral="bi-book" iconColor="#16a34a" iconSize="16"/>
            </graphic>
            <ScrollPane fitToWidth="true" fitToHeight="true">
                <VBox fx:id="documentationContainer" spacing="15" style="-fx-padding: 20;">

                    <!-- Header -->
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <FontIcon iconLiteral="bi-book" iconColor="#16a34a" iconSize="32"/>
                        <VBox spacing="5">
                            <Label text="Schematron Dokumentation" style="-fx-font-size: 18px; -fx-font-weight: bold;"/>
                            <Label text="Automatically generate documentation for your Schematron rules"
                                   style="-fx-text-fill: #6c757d;"/>
                        </VBox>
                    </HBox>

                    <Separator/>

                    <!-- Documentation Options -->
                    <VBox spacing="15">
                        <Label text="Documentation Options:" style="-fx-font-size: 14px; -fx-font-weight: bold;"/>

                        <!-- HTML Documentation -->
                        <HBox spacing="15" style="-fx-border-color: #e9ecef; -fx-border-radius: 5; -fx-padding: 15;">
                            <VBox alignment="CENTER">
                                <FontIcon iconLiteral="bi-file-earmark-code" iconColor="#e67e22" iconSize="32"/>
                            </VBox>
                            <VBox spacing="8" HBox.hgrow="ALWAYS">
                                <Label text="HTML Documentation" style="-fx-font-weight: bold; -fx-font-size: 14px;"/>
                                <Label text="Create interactive HTML documentation with rule overview, examples and explanations"
                                       wrapText="true" style="-fx-text-fill: #6c757d;"/>
                                <HBox spacing="10">
                                    <Button text="Generate HTML">
                                        <graphic>
                                            <FontIcon iconLiteral="bi-file-earmark-code" iconSize="14"/>
                                        </graphic>
                                    </Button>
                                    <Button text="Preview">
                                        <graphic>
                                            <FontIcon iconLiteral="bi-eye" iconSize="14"/>
                                        </graphic>
                                    </Button>
                                </HBox>
                            </VBox>
                        </HBox>

                        <!-- PDF Documentation -->
                        <HBox spacing="15" style="-fx-border-color: #e9ecef; -fx-border-radius: 5; -fx-padding: 15;">
                            <VBox alignment="CENTER">
                                <FontIcon iconLiteral="bi-file-text" iconColor="#dc3545" iconSize="32"/>
                            </VBox>
                            <VBox spacing="8" HBox.hgrow="ALWAYS">
                                <Label text="PDF Documentation" style="-fx-font-weight: bold; -fx-font-size: 14px;"/>
                                <Label text="Generate professional PDF documentation for printing and official documents"
                                       wrapText="true" style="-fx-text-fill: #6c757d;"/>
                                <HBox spacing="10">
                                    <Button text="Generate PDF">
                                        <graphic>
                                            <FontIcon iconLiteral="bi-file-text" iconSize="14"/>
                                        </graphic>
                                    </Button>
                                    <Button text="Customize Template">
                                        <graphic>
                                            <FontIcon iconLiteral="bi-gear" iconSize="14"/>
                                        </graphic>
                                    </Button>
                                </HBox>
                            </VBox>
                        </HBox>

                        <!-- Markdown Documentation -->
                        <HBox spacing="15" style="-fx-border-color: #e9ecef; -fx-border-radius: 5; -fx-padding: 15;">
                            <VBox alignment="CENTER">
                                <FontIcon iconLiteral="bi-file-earmark-text" iconColor="#007bff" iconSize="32"/>
                            </VBox>
                            <VBox spacing="8" HBox.hgrow="ALWAYS">
                                <Label text="Markdown Documentation"
                                       style="-fx-font-weight: bold; -fx-font-size: 14px;"/>
                                <Label text="Create Markdown files for GitHub, Wikis and other documentation platforms"
                                       wrapText="true" style="-fx-text-fill: #6c757d;"/>
                                <HBox spacing="10">
                                    <Button text="Generate Markdown">
                                        <graphic>
                                            <FontIcon iconLiteral="bi-file-earmark-text" iconSize="14"/>
                                        </graphic>
                                    </Button>
                                    <Button text="Create README">
                                        <graphic>
                                            <FontIcon iconLiteral="bi-file-text" iconSize="14"/>
                                        </graphic>
                                    </Button>
                                </HBox>
                            </VBox>
                        </HBox>
                    </VBox>

                    <!-- Documentation Content Settings -->
                    <VBox spacing="10"
                          style="-fx-border-color: #f8f9fa; -fx-border-radius: 5; -fx-background-color: #f8f9fa; -fx-padding: 15;">
                        <Label text="Configure Content:" style="-fx-font-size: 14px; -fx-font-weight: bold;"/>

                        <GridPane hgap="15" vgap="10">
                            <columnConstraints>
                                <ColumnConstraints hgrow="SOMETIMES" minWidth="10.0" prefWidth="50.0"/>
                                <ColumnConstraints hgrow="SOMETIMES" minWidth="10.0" prefWidth="50.0"/>
                            </columnConstraints>

                            <VBox spacing="8" GridPane.columnIndex="0" GridPane.rowIndex="0">
                                <CheckBox text="Rule Overview" selected="true"/>
                                <CheckBox text="XPath Explanations" selected="true"/>
                                <CheckBox text="Error Messages" selected="true"/>
                                <CheckBox text="Examples" selected="false"/>
                            </VBox>

                            <VBox spacing="8" GridPane.columnIndex="1" GridPane.rowIndex="0">
                                <CheckBox text="Table of Contents" selected="true"/>
                                <CheckBox text="Rule Statistics" selected="false"/>
                                <CheckBox text="Best Practices" selected="false"/>
                                <CheckBox text="FAQ Section" selected="false"/>
                            </VBox>
                        </GridPane>
                    </VBox>

                    <!-- Documentation Preview -->
                    <VBox spacing="10">
                        <HBox alignment="CENTER_LEFT" spacing="10">
                            <Label text="Documentation Preview:" style="-fx-font-size: 14px; -fx-font-weight: bold;"/>
                            <Button text="Refresh">
                                <graphic>
                                    <FontIcon iconLiteral="bi-arrow-clockwise" iconSize="14"/>
                                </graphic>
                            </Button>
                        </HBox>

                        <WebView prefHeight="300" style="-fx-border-color: #dee2e6; -fx-border-radius: 5;"/>

                        <HBox spacing="10">
                            <Button text="Fullscreen Preview">
                                <graphic>
                                    <FontIcon iconLiteral="bi-arrows-fullscreen" iconSize="14"/>
                                </graphic>
                            </Button>
                            <Button text="Open in Browser">
                                <graphic>
                                    <FontIcon iconLiteral="bi-box-arrow-up-right" iconSize="14"/>
                                </graphic>
                            </Button>
                        </HBox>
                    </VBox>

                    <!-- Schematron Reference -->
                    <VBox spacing="10">
                        <Label text="Schematron Reference:" style="-fx-font-size: 14px; -fx-font-weight: bold;"/>

                        <Accordion>
                            <panes>
                                <!-- Basic Elements -->
                                <TitledPane text="Basic Elements">
                                    <VBox spacing="10" style="-fx-padding: 10;">
                                        <VBox spacing="5">
                                            <Label text="&lt;schema&gt;"
                                                   style="-fx-font-weight: bold; -fx-font-family: monospace;"/>
                                            <Label text="The root element of a Schematron schema"
                                                   style="-fx-font-size: 12px; -fx-text-fill: #6c757d;"/>
                                        </VBox>

                                        <VBox spacing="5">
                                            <Label text="&lt;pattern id='...'&gt;"
                                                   style="-fx-font-weight: bold; -fx-font-family: monospace;"/>
                                            <Label text="Groups related rules and defines the validation context"
                                                   style="-fx-font-size: 12px; -fx-text-fill: #6c757d;"/>
                                        </VBox>

                                        <VBox spacing="5">
                                            <Label text="&lt;rule context='...'&gt;"
                                                   style="-fx-font-weight: bold; -fx-font-family: monospace;"/>
                                            <Label text="Defines the XPath context to which the contained tests are applied"
                                                   style="-fx-font-size: 12px; -fx-text-fill: #6c757d;"/>
                                        </VBox>
                                    </VBox>
                                </TitledPane>

                                <!-- Test Elements -->
                                <TitledPane text="Test Elements">
                                    <content>
                                        <VBox spacing="10" style="-fx-padding: 10;">
                                            <VBox spacing="5">
                                                <Label text="&lt;assert test='...'&gt;"
                                                       style="-fx-font-weight: bold; -fx-font-family: monospace;"/>
                                                <Label text="Tests whether a condition is true. If false, an error message is displayed"
                                                       style="-fx-font-size: 12px; -fx-text-fill: #6c757d;"/>
                                            </VBox>

                                            <VBox spacing="5">
                                                <Label text="&lt;report test='...'&gt;"
                                                       style="-fx-font-weight: bold; -fx-font-family: monospace;"/>
                                                <Label text="Reports a finding when the condition is true"
                                                       style="-fx-font-size: 12px; -fx-text-fill: #6c757d;"/>
                                            </VBox>
                                        </VBox>
                                    </content>
                                </TitledPane>

                                <!-- Attributes -->
                                <TitledPane text="Important Attributes">
                                    <content>
                                        <VBox spacing="10" style="-fx-padding: 10;">
                                            <VBox spacing="5">
                                                <Label text="id='...'"
                                                       style="-fx-font-weight: bold; -fx-font-family: monospace;"/>
                                                <Label text="Unique identifier for Patterns and Rules"
                                                       style="-fx-font-size: 12px; -fx-text-fill: #6c757d;"/>
                                            </VBox>

                                            <VBox spacing="5">
                                                <Label text="context='...'"
                                                       style="-fx-font-weight: bold; -fx-font-family: monospace;"/>
                                                <Label text="XPath expression that defines the context for a Rule"
                                                       style="-fx-font-size: 12px; -fx-text-fill: #6c757d;"/>
                                            </VBox>

                                            <VBox spacing="5">
                                                <Label text="test='...'"
                                                       style="-fx-font-weight: bold; -fx-font-family: monospace;"/>
                                                <Label text="XPath expression for the condition to be tested"
                                                       style="-fx-font-size: 12px; -fx-text-fill: #6c757d;"/>
                                            </VBox>
                                        </VBox>
                                    </content>
                                </TitledPane>
                            </panes>

                        </Accordion>
                    </VBox>

                    <!-- Help Links -->
                    <VBox spacing="10"
                          style="-fx-border-color: #d4edda; -fx-border-radius: 5; -fx-background-color: #d4edda; -fx-padding: 15;">
                        <HBox alignment="CENTER_LEFT" spacing="8">
                            <FontIcon iconLiteral="bi-info-circle" iconColor="#155724" iconSize="20"/>
                            <Label text="Further Help:" style="-fx-font-weight: bold; -fx-text-fill: #155724;"/>
                        </HBox>
                        <VBox spacing="5">
                            <Button text="Schematron Specification (ISO)"
                                    style="-fx-background-color: transparent; -fx-text-fill: #155724; -fx-underline: true;">
                                <graphic>
                                    <FontIcon iconLiteral="bi-box-arrow-up-right" iconColor="#155724" iconSize="12"/>
                                </graphic>
                            </Button>
                            <Button text="XPath 2.0 Reference"
                                    style="-fx-background-color: transparent; -fx-text-fill: #155724; -fx-underline: true;">
                                <graphic>
                                    <FontIcon iconLiteral="bi-box-arrow-up-right" iconColor="#155724" iconSize="12"/>
                                </graphic>
                            </Button>
                            <Button text="Schematron Tutorial"
                                    style="-fx-background-color: transparent; -fx-text-fill: #155724; -fx-underline: true;">
                                <graphic>
                                    <FontIcon iconLiteral="bi-box-arrow-up-right" iconColor="#155724" iconSize="12"/>
                                </graphic>
                            </Button>
                        </VBox>
                    </VBox>

                </VBox>
            </ScrollPane>
        </Tab>

    </TabPane>

</VBox>
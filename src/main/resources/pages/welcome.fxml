<?xml version="1.0" encoding="UTF-8"?>

<!--
  ~ FreeXMLToolkit - Universal Toolkit for XML
  ~ Copyright (c) Karl Kauc 2024.
  ~
  ~  Licensed under the Apache License, Version 2.0 (the "License");
  ~  you may not use this file except in compliance with the License.
  ~  You may obtain a copy of the License at
  ~
  ~      http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~  Unless required by applicable law or agreed to in writing, software
  ~  distributed under the License is distributed on an "AS IS" BASIS,
  ~  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~  See the License for the specific language governing permissions and
  ~  limitations under the License.
  ~
  -->

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import org.kordamp.ikonli.javafx.*?>
<AnchorPane fx:id="rootPane" xmlns="http://javafx.com/javafx/21"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="org.fxt.freexmltoolkit.controller.WelcomeController"
            styleClass="dashboard-root"
            AnchorPane.bottomAnchor="0" AnchorPane.leftAnchor="0"
            AnchorPane.rightAnchor="0" AnchorPane.topAnchor="0">

    <ScrollPane fitToWidth="true" fitToHeight="true" hbarPolicy="AS_NEEDED" vbarPolicy="AS_NEEDED"
                AnchorPane.bottomAnchor="0" AnchorPane.leftAnchor="0"
                AnchorPane.rightAnchor="0" AnchorPane.topAnchor="0"
                styleClass="dashboard-scroll">
        <VBox spacing="24" styleClass="dashboard-container">
            <padding>
                <Insets bottom="24" left="24" right="24" top="24"/>
            </padding>

            <!-- Update Notification -->
            <HBox fx:id="versionUpdate" managed="false" visible="false" spacing="8" alignment="CENTER_LEFT"
                  styleClass="update-notification">
                <padding>
                    <Insets bottom="12" left="16" right="16" top="12"/>
                </padding>
                <FontIcon iconLiteral="bi-info-circle-fill" iconSize="16" iconColor="#0ea5e9"/>
                <Label text="An update is available!" style="-fx-font-weight: bold"/>
                <Hyperlink fx:id="updateLink" onAction="#openUpdatePage" text="Download latest version"/>
            </HBox>

            <!-- Welcome Header -->
            <VBox spacing="4">
                <Label fx:id="welcomeLabel" text="Welcome back, Developer" styleClass="dashboard-title"/>
                <Label text="Pick up where you left off or start a new project." styleClass="dashboard-subtitle"/>
            </VBox>

            <!-- Action Cards Row 1 -->
            <HBox spacing="16" VBox.vgrow="NEVER">
                <!-- New XML File Card -->
                <VBox styleClass="action-card" spacing="8" HBox.hgrow="ALWAYS" minHeight="160" maxHeight="160"
                      onMouseClicked="#createNewXmlFile">
                    <StackPane styleClass="action-card-icon-wrapper, action-card-icon-blue">
                        <FontIcon iconLiteral="bi-plus" iconSize="24" iconColor="#2563eb"/>
                    </StackPane>
                    <Label text="New XML File" styleClass="action-card-title"/>
                    <Label text="Create a blank XML document." styleClass="action-card-description" wrapText="true"/>
                    <Region VBox.vgrow="ALWAYS"/>
                    <HBox alignment="CENTER_LEFT" spacing="4" styleClass="action-card-link">
                        <Label text="Create File" styleClass="action-link-text"/>
                        <FontIcon iconLiteral="bi-arrow-right" iconSize="14" iconColor="#2563eb"/>
                    </HBox>
                </VBox>

                <!-- XSD Schema Editor Card -->
                <VBox styleClass="action-card" spacing="8" HBox.hgrow="ALWAYS" minHeight="160" maxHeight="160"
                      onMouseClicked="#openXsdTools">
                    <StackPane styleClass="action-card-icon-wrapper, action-card-icon-purple">
                        <FontIcon iconLiteral="bi-file-earmark-code" iconSize="24" iconColor="#9333ea"/>
                    </StackPane>
                    <Label text="XSD Schema Editor" styleClass="action-card-title"/>
                    <Label text="Design schemas visually or via code." styleClass="action-card-description" wrapText="true"/>
                    <Region VBox.vgrow="ALWAYS"/>
                    <HBox alignment="CENTER_LEFT" spacing="4" styleClass="action-card-link">
                        <Label text="Open Editor" styleClass="action-link-text"/>
                        <FontIcon iconLiteral="bi-arrow-right" iconSize="14" iconColor="#2563eb"/>
                    </HBox>
                </VBox>

                <!-- Validate Document Card -->
                <VBox styleClass="action-card" spacing="8" HBox.hgrow="ALWAYS" minHeight="160" maxHeight="160"
                      onMouseClicked="#openValidation">
                    <StackPane styleClass="action-card-icon-wrapper, action-card-icon-green">
                        <FontIcon iconLiteral="bi-file-earmark-check" iconSize="24" iconColor="#16a34a"/>
                    </StackPane>
                    <Label text="Validate Document" styleClass="action-card-title"/>
                    <Label text="Validate against XSD or DTD." styleClass="action-card-description" wrapText="true"/>
                    <Region VBox.vgrow="ALWAYS"/>
                    <HBox alignment="CENTER_LEFT" spacing="4" styleClass="action-card-link">
                        <Label text="Run Validation" styleClass="action-link-text"/>
                        <FontIcon iconLiteral="bi-arrow-right" iconSize="14" iconColor="#2563eb"/>
                    </HBox>
                </VBox>

                <!-- XSLT Developer Card -->
                <VBox styleClass="action-card" spacing="8" HBox.hgrow="ALWAYS" minHeight="160" maxHeight="160"
                      onMouseClicked="#openXsltDeveloper">
                    <StackPane styleClass="action-card-icon-wrapper, action-card-icon-yellow">
                        <FontIcon iconLiteral="bi-arrow-repeat" iconSize="24" iconColor="#d97706"/>
                    </StackPane>
                    <Label text="XSLT Developer" styleClass="action-card-title"/>
                    <Label text="Transform XML with XSLT." styleClass="action-card-description" wrapText="true"/>
                    <Region VBox.vgrow="ALWAYS"/>
                    <HBox alignment="CENTER_LEFT" spacing="4" styleClass="action-card-link">
                        <Label text="Open XSLT" styleClass="action-link-text"/>
                        <FontIcon iconLiteral="bi-arrow-right" iconSize="14" iconColor="#2563eb"/>
                    </HBox>
                </VBox>
            </HBox>

            <!-- Action Cards Row 2 -->
            <HBox spacing="16" VBox.vgrow="NEVER">
                <!-- JSON Editor Card -->
                <VBox styleClass="action-card" spacing="8" HBox.hgrow="ALWAYS" minHeight="160" maxHeight="160"
                      onMouseClicked="#openJsonEditor">
                    <StackPane styleClass="action-card-icon-wrapper, action-card-icon-orange">
                        <FontIcon iconLiteral="bi-braces" iconSize="24" iconColor="#ea580c"/>
                    </StackPane>
                    <Label text="JSON Editor" styleClass="action-card-title"/>
                    <Label text="Edit, validate and query JSON." styleClass="action-card-description" wrapText="true"/>
                    <Region VBox.vgrow="ALWAYS"/>
                    <HBox alignment="CENTER_LEFT" spacing="4" styleClass="action-card-link">
                        <Label text="Open JSON Editor" styleClass="action-link-text"/>
                        <FontIcon iconLiteral="bi-arrow-right" iconSize="14" iconColor="#2563eb"/>
                    </HBox>
                </VBox>

                <!-- Schematron Card -->
                <VBox styleClass="action-card" spacing="8" HBox.hgrow="ALWAYS" minHeight="160" maxHeight="160"
                      onMouseClicked="#openSchematron">
                    <StackPane styleClass="action-card-icon-wrapper, action-card-icon-pink">
                        <FontIcon iconLiteral="bi-shield-check" iconSize="24" iconColor="#be185d"/>
                    </StackPane>
                    <Label text="Schematron" styleClass="action-card-title"/>
                    <Label text="Validate with business rules." styleClass="action-card-description" wrapText="true"/>
                    <Region VBox.vgrow="ALWAYS"/>
                    <HBox alignment="CENTER_LEFT" spacing="4" styleClass="action-card-link">
                        <Label text="Open Schematron" styleClass="action-link-text"/>
                        <FontIcon iconLiteral="bi-arrow-right" iconSize="14" iconColor="#2563eb"/>
                    </HBox>
                </VBox>

                <!-- Schema Generator Card -->
                <VBox styleClass="action-card" spacing="8" HBox.hgrow="ALWAYS" minHeight="160" maxHeight="160"
                      onMouseClicked="#openSchemaGenerator">
                    <StackPane styleClass="action-card-icon-wrapper, action-card-icon-cyan">
                        <FontIcon iconLiteral="bi-diagram-3" iconSize="24" iconColor="#0891b2"/>
                    </StackPane>
                    <Label text="Schema Generator" styleClass="action-card-title"/>
                    <Label text="Generate XSD from XML." styleClass="action-card-description" wrapText="true"/>
                    <Region VBox.vgrow="ALWAYS"/>
                    <HBox alignment="CENTER_LEFT" spacing="4" styleClass="action-card-link">
                        <Label text="Generate Schema" styleClass="action-link-text"/>
                        <FontIcon iconLiteral="bi-arrow-right" iconSize="14" iconColor="#2563eb"/>
                    </HBox>
                </VBox>

                <!-- PDF Generation Card -->
                <VBox styleClass="action-card" spacing="8" HBox.hgrow="ALWAYS" minHeight="160" maxHeight="160"
                      onMouseClicked="#openFop">
                    <StackPane styleClass="action-card-icon-wrapper, action-card-icon-violet">
                        <FontIcon iconLiteral="bi-printer" iconSize="24" iconColor="#7c3aed"/>
                    </StackPane>
                    <Label text="PDF Generation" styleClass="action-card-title"/>
                    <Label text="Generate PDFs with Apache FOP." styleClass="action-card-description" wrapText="true"/>
                    <Region VBox.vgrow="ALWAYS"/>
                    <HBox alignment="CENTER_LEFT" spacing="4" styleClass="action-card-link">
                        <Label text="Open FOP" styleClass="action-link-text"/>
                        <FontIcon iconLiteral="bi-arrow-right" iconSize="14" iconColor="#2563eb"/>
                    </HBox>
                </VBox>

                <!-- XML Digital Signature Card -->
                <VBox styleClass="action-card" spacing="8" HBox.hgrow="ALWAYS" minHeight="160" maxHeight="160"
                      onMouseClicked="#openSignature">
                    <StackPane styleClass="action-card-icon-wrapper, action-card-icon-amber">
                        <FontIcon iconLiteral="bi-key" iconSize="24" iconColor="#ca8a04"/>
                    </StackPane>
                    <Label text="XML Signature" styleClass="action-card-title"/>
                    <Label text="Sign and verify XML documents." styleClass="action-card-description" wrapText="true"/>
                    <Region VBox.vgrow="ALWAYS"/>
                    <HBox alignment="CENTER_LEFT" spacing="4" styleClass="action-card-link">
                        <Label text="Open Signature" styleClass="action-link-text"/>
                        <FontIcon iconLiteral="bi-arrow-right" iconSize="14" iconColor="#2563eb"/>
                    </HBox>
                </VBox>
            </HBox>

            <!-- Statistics Dashboard (Gamification) -->
            <TitledPane fx:id="statisticsPane" text="Your Progress" expanded="true" styleClass="statistics-pane">
                <VBox fx:id="statisticsDashboard" spacing="16" styleClass="statistics-dashboard">
                    <!-- Content will be populated programmatically by WelcomeController -->
                </VBox>
            </TitledPane>

            <!-- Main Content Area: Recent Projects + System Updates -->
            <HBox spacing="24" VBox.vgrow="ALWAYS">
                <!-- Recent Projects (Left, 2/3 width) -->
                <VBox HBox.hgrow="ALWAYS" spacing="0" styleClass="recent-projects-card" minWidth="400">
                    <!-- Header -->
                    <HBox alignment="CENTER_LEFT" spacing="8" styleClass="recent-projects-header">
                        <FontIcon iconLiteral="bi-file-earmark-text" iconSize="18" iconColor="#6b7280"/>
                        <Label text="Recent Projects" styleClass="section-title"/>
                        <Region HBox.hgrow="ALWAYS"/>
                        <Hyperlink text="View all" onAction="#openRecentFilesDialog"/>
                    </HBox>

                    <!-- Drag & Drop Area -->
                    <VBox fx:id="dragDropArea" alignment="CENTER" spacing="8" styleClass="drag-drop-area">
                        <FontIcon iconLiteral="bi-cloud-arrow-up" iconSize="20" iconColor="#9ca3af"/>
                        <Label text="Drag &amp; drop files here to open quickly" styleClass="drag-drop-text"/>
                    </VBox>

                    <!-- Recent Files Grid -->
                    <ScrollPane fitToWidth="true" VBox.vgrow="ALWAYS" styleClass="recent-files-scroll"
                                minHeight="150" maxHeight="250" hbarPolicy="NEVER">
                        <FlowPane fx:id="recentFilesGrid" hgap="12" vgap="12" styleClass="recent-files-grid">
                            <padding>
                                <Insets bottom="12" left="12" right="12" top="12"/>
                            </padding>
                        </FlowPane>
                    </ScrollPane>

                    <!-- Empty State Placeholder -->
                    <VBox fx:id="emptyFilesPlaceholder" alignment="CENTER" spacing="8"
                          managed="false" visible="false" minHeight="150">
                        <FontIcon iconLiteral="bi-folder2-open" iconSize="32" iconColor="#9ca3af"/>
                        <Label text="No recent files" styleClass="placeholder-text"/>
                    </VBox>
                </VBox>

                <!-- Right Sidebar (1/3 width) -->
                <VBox spacing="24" minWidth="280" maxWidth="320">
                    <!-- System Updates Section -->
                    <VBox styleClass="system-updates-card" spacing="12">
                        <HBox alignment="CENTER_LEFT" spacing="8">
                            <Label text="System Updates" styleClass="section-title"/>
                            <Region HBox.hgrow="ALWAYS"/>
                            <Label fx:id="versionBadge" text="v2.0" styleClass="version-badge"/>
                        </HBox>

                        <VBox spacing="8">
                            <HBox alignment="CENTER_LEFT" spacing="8">
                                <StackPane styleClass="update-check-icon">
                                    <FontIcon iconLiteral="bi-check" iconSize="12" iconColor="#16a34a"/>
                                </StackPane>
                                <Label text="NEW: JSON Editor with Tree View" styleClass="update-item-text"/>
                            </HBox>
                            <HBox alignment="CENTER_LEFT" spacing="8">
                                <StackPane styleClass="update-check-icon">
                                    <FontIcon iconLiteral="bi-check" iconSize="12" iconColor="#16a34a"/>
                                </StackPane>
                                <Label text="JSONPath Queries &amp; Schema Validation" styleClass="update-item-text"/>
                            </HBox>
                            <HBox alignment="CENTER_LEFT" spacing="8">
                                <StackPane styleClass="update-check-icon">
                                    <FontIcon iconLiteral="bi-check" iconSize="12" iconColor="#16a34a"/>
                                </StackPane>
                                <Label text="Support for JSONC and JSON5" styleClass="update-item-text"/>
                            </HBox>
                        </VBox>

                        <HBox alignment="CENTER_LEFT" spacing="4" styleClass="changelog-link">
                            <Hyperlink text="Read Changelog" onAction="#openChangelog"/>
                            <FontIcon iconLiteral="bi-arrow-right" iconSize="14" iconColor="#2563eb"/>
                        </HBox>
                    </VBox>

                    <!-- Spacer -->
                    <Region VBox.vgrow="ALWAYS"/>
                </VBox>
            </HBox>

            <!-- Footer -->
            <Separator/>
            <HBox alignment="CENTER" spacing="30">
                <HBox alignment="CENTER_LEFT" spacing="5">
                    <FontIcon iconLiteral="bi-info-circle" iconSize="14" iconColor="#6c757d"/>
                    <Label fx:id="versionLabel" text="Version: loading..."
                           styleClass="footer-label"/>
                </HBox>
                <HBox alignment="CENTER_LEFT" spacing="5">
                    <FontIcon iconLiteral="bi-clock" iconSize="14" iconColor="#6c757d"/>
                    <Label fx:id="durationLabel" text="Total usage time: loading..."
                           styleClass="footer-label"/>
                </HBox>
            </HBox>
        </VBox>
    </ScrollPane>
</AnchorPane>

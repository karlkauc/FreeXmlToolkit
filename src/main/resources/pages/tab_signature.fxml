<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import org.kordamp.ikonli.javafx.*?>
<AnchorPane xmlns="http://javafx.com/javafx/11.0.14-internal"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="org.fxt.freexmltoolkit.controller.SignatureController"
            AnchorPane.bottomAnchor="0" AnchorPane.leftAnchor="0" AnchorPane.rightAnchor="0" AnchorPane.topAnchor="0">

    <TabPane tabClosingPolicy="UNAVAILABLE" AnchorPane.bottomAnchor="0" AnchorPane.leftAnchor="0"
             AnchorPane.rightAnchor="0" AnchorPane.topAnchor="0">

        <!-- ===================================================================== -->
        <!-- TAB 1: ZERTIFIKAT ERSTELLEN                                           -->
        <!-- ===================================================================== -->
        <Tab text="Create Certificate">
            <graphic>
                <FontIcon iconLiteral="bi-file-earmark-plus" iconSize="16"/>
            </graphic>
            <content>
                <ScrollPane fitToWidth="true" style="-fx-background-color: -fx-background-color;">
                    <VBox spacing="20" style="-fx-padding: 20;">

                        <!-- Karte 1: Distinguished Name (DN) Details -->
                        <VBox styleClass="card">
                            <Label styleClass="card-title" text="Distinguished Name (DN) Details"/>
                            <Separator/>
                            <GridPane hgap="10" vgap="10" style="-fx-padding: 15 0 0 0;">
                                <Label text="CommonName (CN):" GridPane.columnIndex="0" GridPane.rowIndex="0"/>
                                <TextField fx:id="commonName" promptText="e.g., Karl Kauc" GridPane.columnIndex="1"
                                           GridPane.rowIndex="0"/>
                                <Label text="OrganizationalUnit (OU):" GridPane.columnIndex="0" GridPane.rowIndex="1"/>
                                <TextField fx:id="organizationUnit" promptText="e.g., IT Department"
                                           GridPane.columnIndex="1" GridPane.rowIndex="1"/>
                                <Label text="Organization (O):" GridPane.columnIndex="0" GridPane.rowIndex="2"/>
                                <TextField fx:id="organizationName" promptText="e.g., FreeXmlToolkit"
                                           GridPane.columnIndex="1" GridPane.rowIndex="2"/>
                                <Label text="Locality (L):" GridPane.columnIndex="0" GridPane.rowIndex="3"/>
                                <TextField fx:id="localityName" promptText="e.g., Vienna" GridPane.columnIndex="1"
                                           GridPane.rowIndex="3"/>
                                <Label text="State/Province (ST):" GridPane.columnIndex="0" GridPane.rowIndex="4"/>
                                <TextField fx:id="streetName" promptText="e.g., Vienna" GridPane.columnIndex="1"
                                           GridPane.rowIndex="4"/>
                                <Label text="Country (C):" GridPane.columnIndex="0" GridPane.rowIndex="5"/>
                                <TextField fx:id="country" promptText="e.g., AT" GridPane.columnIndex="1"
                                           GridPane.rowIndex="5"/>
                                <Label text="Email (E):" GridPane.columnIndex="0" GridPane.rowIndex="6"/>
                                <TextField fx:id="email" promptText="e.g., your.email@example.com"
                                           GridPane.columnIndex="1" GridPane.rowIndex="6"/>
                                <columnConstraints>
                                    <ColumnConstraints hgrow="SOMETIMES" minWidth="10.0" prefWidth="150.0"/>
                                    <ColumnConstraints hgrow="ALWAYS"/>
                                </columnConstraints>
                            </GridPane>
                        </VBox>

                        <!-- Karte 2: Keystore Sicherheit -->
                        <VBox styleClass="card">
                            <Label styleClass="card-title" text="Keystore Security"/>
                            <Separator/>
                            <GridPane hgap="10" vgap="10" style="-fx-padding: 15 0 0 0;">
                                <Label text="Keystore Alias*:" GridPane.columnIndex="0" GridPane.rowIndex="0"/>
                                <TextField fx:id="createCertificateAlias" promptText="A unique name for your key"
                                           GridPane.columnIndex="1" GridPane.rowIndex="0"/>
                                <Label text="Keystore Password*:" GridPane.columnIndex="0" GridPane.rowIndex="1"/>
                                <PasswordField fx:id="createCertificateKeystorePassword"
                                               promptText="Password for the .jks file" GridPane.columnIndex="1"
                                               GridPane.rowIndex="1"/>
                                <Label text="Alias Password*:" GridPane.columnIndex="0" GridPane.rowIndex="2"/>
                                <PasswordField fx:id="createCertificateAliasPassword"
                                               promptText="Password for the key inside the keystore"
                                               GridPane.columnIndex="1" GridPane.rowIndex="2"/>
                                <columnConstraints>
                                    <ColumnConstraints hgrow="SOMETIMES" minWidth="10.0" prefWidth="150.0"/>
                                    <ColumnConstraints hgrow="ALWAYS"/>
                                </columnConstraints>
                            </GridPane>
                        </VBox>

                        <!-- Action Button -->
                        <Button onAction="#createNewSignatureFile" text="Create Certificate and Keystore"
                                maxWidth="Infinity" styleClass="button, :default">
                            <graphic>
                                <FontIcon iconLiteral="bi-shield-lock" iconSize="16"/>
                            </graphic>
                        </Button>
                    </VBox>
                </ScrollPane>
            </content>
        </Tab>

        <!-- ===================================================================== -->
        <!-- TAB 2: XML DATEI SIGNIEREN                                            -->
        <!-- ===================================================================== -->
        <Tab text="Sign XML File">
            <graphic>
                <FontIcon iconLiteral="bi-pencil-square" iconSize="16"/>
            </graphic>
            <content>
                <ScrollPane fitToWidth="true" style="-fx-background-color: -fx-background-color;">
                    <VBox spacing="20" style="-fx-padding: 20;">

                        <!-- Karte 1: Eingabedateien -->
                        <VBox styleClass="card">
                            <Label styleClass="card-title" text="Input Files"/>
                            <Separator/>
                            <GridPane hgap="10" vgap="10" style="-fx-padding: 15 0 0 0;">
                                <Button fx:id="signLoadXmlFileButton" text="XML File*" GridPane.columnIndex="0"
                                        GridPane.rowIndex="0">
                                    <graphic>
                                        <FontIcon iconLiteral="bi-file-earmark-code" iconSize="16"/>
                                    </graphic>
                                </Button>
                                <Label fx:id="xmlFileInfo" text="No file selected" GridPane.columnIndex="1"
                                       GridPane.rowIndex="0"/>

                                <Button fx:id="signLoadKeystoreButton" text="Keystore File*"
                                        GridPane.columnIndex="0" GridPane.rowIndex="1">
                                    <graphic>
                                        <FontIcon iconLiteral="bi-key" iconSize="16"/>
                                    </graphic>
                                </Button>
                                <Label fx:id="certFileInfo" text="No file selected" GridPane.columnIndex="1"
                                       GridPane.rowIndex="1"/>
                                <columnConstraints>
                                    <ColumnConstraints hgrow="SOMETIMES" minWidth="10.0" prefWidth="150.0"/>
                                    <ColumnConstraints hgrow="ALWAYS"/>
                                </columnConstraints>
                            </GridPane>
                        </VBox>

                        <!-- Karte 2: Keystore Zugangsdaten -->
                        <VBox styleClass="card">
                            <Label styleClass="card-title" text="Keystore Credentials"/>
                            <Separator/>
                            <GridPane hgap="10" vgap="10" style="-fx-padding: 15 0 0 0;">
                                <Label text="Keystore Alias*:" GridPane.columnIndex="0" GridPane.rowIndex="0"/>
                                <TextField fx:id="signKeystoreAlias" promptText="The alias used during creation"
                                           GridPane.columnIndex="1" GridPane.rowIndex="0"/>
                                <Label text="Keystore Password*:" GridPane.columnIndex="0" GridPane.rowIndex="1"/>
                                <PasswordField fx:id="signKeystorePassword" promptText="Password for the .jks file"
                                               GridPane.columnIndex="1" GridPane.rowIndex="1"/>
                                <Label text="Alias Password*:" GridPane.columnIndex="0" GridPane.rowIndex="2"/>
                                <PasswordField fx:id="signAliasPassword" promptText="Password for the key"
                                               GridPane.columnIndex="1" GridPane.rowIndex="2"/>
                                <columnConstraints>
                                    <ColumnConstraints hgrow="SOMETIMES" minWidth="10.0" prefWidth="150.0"/>
                                    <ColumnConstraints hgrow="ALWAYS"/>
                                </columnConstraints>
                            </GridPane>
                        </VBox>

                        <!-- Karte 3: Ausgabe -->
                        <VBox styleClass="card">
                            <Label styleClass="card-title" text="Output Settings"/>
                            <Separator/>
                            <GridPane hgap="10" vgap="10" style="-fx-padding: 15 0 0 0;">
                                <Label text="New Filename Postfix:" GridPane.columnIndex="0" GridPane.rowIndex="0"/>
                                <TextField fx:id="newFileName" text="_signed" GridPane.columnIndex="1"
                                           GridPane.rowIndex="0"/>
                                <columnConstraints>
                                    <ColumnConstraints hgrow="SOMETIMES" minWidth="10.0" prefWidth="150.0"/>
                                    <ColumnConstraints hgrow="ALWAYS"/>
                                </columnConstraints>
                            </GridPane>
                        </VBox>

                        <!-- Action Button -->
                        <Button onAction="#signDocument" text="Sign Document" maxWidth="Infinity"
                                styleClass="button, :default">
                            <graphic>
                                <FontIcon iconLiteral="bi-check-circle" iconSize="16"/>
                            </graphic>
                        </Button>
                    </VBox>
                </ScrollPane>
            </content>
        </Tab>

        <!-- ===================================================================== -->
        <!-- TAB 3: SIGNATUR VALIDIEREN                                            -->
        <!-- ===================================================================== -->
        <Tab text="Validate Signed File">
            <graphic>
                <FontIcon iconLiteral="bi-patch-check" iconSize="16"/>
            </graphic>
            <content>
                <ScrollPane fitToWidth="true" style="-fx-background-color: -fx-background-color;">
                    <VBox spacing="20" style="-fx-padding: 20;">

                        <!-- Karte 1: Eingabedatei -->
                        <VBox styleClass="card">
                            <Label styleClass="card-title" text="Input File"/>
                            <Separator/>
                            <GridPane hgap="10" vgap="10" style="-fx-padding: 15 0 0 0;">
                                <Button fx:id="validateLoadXmlFileButton" text="Signed XML File*"
                                        GridPane.columnIndex="0" GridPane.rowIndex="0">
                                    <graphic>
                                        <FontIcon iconLiteral="bi-file-earmark-code" iconSize="16"/>
                                    </graphic>
                                </Button>
                                <Label fx:id="validateXmlFileInfo" text="No file selected" GridPane.columnIndex="1"
                                       GridPane.rowIndex="0"/>
                                <columnConstraints>
                                    <ColumnConstraints hgrow="SOMETIMES" minWidth="10.0" prefWidth="150.0"/>
                                    <ColumnConstraints hgrow="ALWAYS"/>
                                </columnConstraints>
                            </GridPane>
                        </VBox>

                        <!-- Action Button -->
                        <Button onAction="#validateSignedDocument" text="Validate Document" maxWidth="Infinity"
                                styleClass="button, :default">
                            <graphic>
                                <FontIcon iconLiteral="bi-search" iconSize="16"/>
                            </graphic>
                        </Button>
                    </VBox>
                </ScrollPane>
            </content>
        </Tab>
    </TabPane>
</AnchorPane>
<?xml version="1.0" encoding="UTF-8"?>

<!--
  ~ FreeXMLToolkit - Universal Toolkit for XML
  ~ Copyright (c) Karl Kauc 2024.
  ~
  ~  Licensed under the Apache License, Version 2.0 (the "License");
  ~  you may not use this file except in compliance with the License.
  ~  You may obtain a copy of the License at
  ~
  ~      http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~  Unless required by applicable law or agreed to in writing, software
  ~  distributed under the License is distributed on an "AS IS" BASIS,
  ~  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~  See the License for the specific language governing permissions and
  ~  limitations under the License.
  ~
  -->

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import org.kordamp.ikonli.javafx.*?>
<AnchorPane xmlns="http://javafx.com/javafx/11.0.14-internal"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="org.fxt.freexmltoolkit.controller.SettingsController"
            AnchorPane.bottomAnchor="0" AnchorPane.leftAnchor="0" AnchorPane.rightAnchor="0"
            AnchorPane.topAnchor="0"
            styleClass="settings-root">

    <VBox spacing="20.0" style="-fx-padding: 20;" AnchorPane.bottomAnchor="0" AnchorPane.leftAnchor="0" AnchorPane.rightAnchor="0" AnchorPane.topAnchor="0">

        <!-- Page Header -->
        <VBox styleClass="settings-page-header">
            <Label text="Application Settings" styleClass="settings-page-title"/>
            <Label text="Configure application behavior and preferences"
                   styleClass="settings-section-hint" style="-fx-padding: 5 0 0 0;"/>
        </VBox>

        <!-- Settings TabPane -->
        <TabPane tabClosingPolicy="UNAVAILABLE" VBox.vgrow="ALWAYS"
                 styleClass="settings-tab-pane">

            <!-- Tab 1: Interface & Files -->
            <Tab text="Interface &amp; Files" closable="false">
                <graphic>
                    <FontIcon iconLiteral="bi-palette" iconSize="16" iconColor="#4a90e2"/>
                </graphic>
                <content>
                    <ScrollPane fitToWidth="true" styleClass="dashboard-scroll">
                        <VBox styleClass="settings-tab-content" spacing="20">
                            <Label text="Interface &amp; File Configuration"
                                   styleClass="settings-section-title"/>

                            <!-- User Information Section (moved to top) -->
                            <VBox spacing="12" styleClass="settings-section, settings-section-purple">
                                <Label text="User Information (optional)"
                                       styleClass="settings-section-subtitle"/>
                                <Label text="This information is used for document metadata and signatures"
                                       styleClass="settings-section-hint"/>
                                <GridPane hgap="12" vgap="10">
                                    <Label text="Name:" GridPane.columnIndex="0" GridPane.rowIndex="0"/>
                                    <TextField fx:id="userName" promptText="Your name" GridPane.columnIndex="1" GridPane.rowIndex="0"/>

                                    <Label text="Email:" GridPane.columnIndex="0" GridPane.rowIndex="1"/>
                                    <TextField fx:id="userEmail" promptText="your.email@example.com" GridPane.columnIndex="1" GridPane.rowIndex="1"/>

                                    <Label text="Company:" GridPane.columnIndex="0" GridPane.rowIndex="2"/>
                                    <TextField fx:id="userCompany" promptText="Your company" GridPane.columnIndex="1" GridPane.rowIndex="2"/>

                                    <columnConstraints>
                                        <ColumnConstraints hgrow="NEVER" minWidth="150.0"/>
                                        <ColumnConstraints hgrow="ALWAYS"/>
                                    </columnConstraints>
                                </GridPane>
                            </VBox>

                            <!-- User Interface Settings -->
                            <VBox spacing="12" styleClass="settings-section, settings-section-blue">
                                <Label text="User Interface"
                                       styleClass="settings-section-subtitle"/>
                                <GridPane hgap="12" vgap="10">
                                    <Label text="Theme:" GridPane.columnIndex="0" GridPane.rowIndex="0"/>
                                    <VBox spacing="6" GridPane.columnIndex="1" GridPane.rowIndex="0">
                                        <RadioButton fx:id="lightTheme" mnemonicParsing="false" text="Light Mode">
                                            <toggleGroup>
                                                <ToggleGroup fx:id="theme"/>
                                            </toggleGroup>
                                        </RadioButton>
                                        <RadioButton fx:id="darkTheme" mnemonicParsing="false" text="Dark Mode" toggleGroup="$theme"/>
                                    </VBox>

                                    <Label text="Default XML Font Size:" GridPane.columnIndex="0" GridPane.rowIndex="1"/>
                                    <Spinner fx:id="xmlFontSize" editable="true" initialValue="12" min="8" max="24" prefWidth="100"
                                             GridPane.columnIndex="1" GridPane.rowIndex="1"/>

                                    <Label text="XML Editor Theme:" GridPane.columnIndex="0" GridPane.rowIndex="2"/>
                                    <ComboBox fx:id="xmlThemeComboBox" prefWidth="200" GridPane.columnIndex="1"
                                              GridPane.rowIndex="2"/>

                                    <Label text="Toolbar Icons:" GridPane.columnIndex="0" GridPane.rowIndex="3"/>
                                    <VBox spacing="6" GridPane.columnIndex="1" GridPane.rowIndex="3">
                                        <CheckBox fx:id="useSmallIcons" text="Use small icons (more screen space)"/>
                                        <Label text="Toolbar buttons will show icons only without text labels"
                                               styleClass="settings-section-hint"/>
                                    </VBox>

                                    <columnConstraints>
                                        <ColumnConstraints hgrow="NEVER" minWidth="150.0"/>
                                        <ColumnConstraints hgrow="ALWAYS"/>
                                    </columnConstraints>
                                </GridPane>
                            </VBox>

                            <!-- File & Folder Settings -->
                            <VBox spacing="12" styleClass="settings-section, settings-section-yellow">
                                <Label text="Temporary Folder Configuration"
                                       styleClass="settings-section-subtitle"/>
                                <VBox spacing="8">
                                    <RadioButton fx:id="useSystemTempFolder" text="Use System Temp Folder">
                                        <toggleGroup>
                                            <ToggleGroup fx:id="tempFolder"/>
                                        </toggleGroup>
                                    </RadioButton>
                                    <RadioButton fx:id="useCustomTempFolder" text="Use Custom Temp Folder:"
                                                 toggleGroup="$tempFolder"/>
                                    <HBox spacing="8" alignment="CENTER_LEFT">
                                        <TextField fx:id="customTempFolder" promptText="C:/temp" HBox.hgrow="ALWAYS"
                                                   styleClass="settings-text-field"/>
                                        <Button onAction="#selectCustomTempFolder" text="Browse..."
                                                styleClass="btn-gray"/>
                                    </HBox>
                                </VBox>
                            </VBox>

                            <!-- Progress Dashboard & Local Statistics -->
                            <VBox spacing="12" styleClass="settings-section, settings-section-cyan">
                                <Label text="Progress Dashboard"
                                       styleClass="settings-section-subtitle"/>
                                <VBox spacing="8">
                                    <CheckBox fx:id="localTrackingEnabled" text="Track local usage statistics"/>
                                    <Label text="Track your productivity metrics locally (never leaves your computer)"
                                           styleClass="settings-section-hint"/>
                                </VBox>
                                <HBox spacing="12" alignment="CENTER_LEFT">
                                    <Button fx:id="clearStatisticsButton" mnemonicParsing="false" onAction="#clearStatistics"
                                            text="Clear Statistics"
                                            styleClass="btn-warning-action">
                                        <graphic>
                                            <FontIcon iconLiteral="bi-trash" iconSize="14"/>
                                        </graphic>
                                    </Button>
                                    <Label text="This will reset all your progress data"
                                           styleClass="settings-section-hint"/>
                                </HBox>
                            </VBox>

                            <!-- Usage Statistics & Cache Settings -->
                            <VBox spacing="12" styleClass="settings-section, settings-section-green">
                                <Label text="Usage Statistics &amp; Cache"
                                       styleClass="settings-section-subtitle"/>
                                <VBox spacing="8">
                                    <CheckBox fx:id="sendUsageStatistics" text="Send anonymous usage statistics"/>
                                    <Label text="Help improve the application by sharing anonymous usage data"
                                           styleClass="settings-section-hint"/>
                                </VBox>

                                <!-- Cache Information -->
                                <VBox spacing="6" styleClass="settings-section-green-dark">
                                    <HBox spacing="8" alignment="CENTER_LEFT">
                                        <FontIcon iconLiteral="bi-folder2" iconSize="14" iconColor="#28a745"/>
                                        <Label text="Cache Folder:"
                                               styleClass="settings-section-subtitle"/>
                                    </HBox>
                                    <Label fx:id="cachePathLabel" text="Loading..."
                                           style="-fx-font-size: 11px; -fx-text-fill: #495057; -fx-font-family: monospace;" wrapText="true"/>
                                    <HBox spacing="12" alignment="CENTER_LEFT">
                                        <Label fx:id="cacheSizeLabel" text="Cache size: calculating..."
                                               styleClass="settings-section-hint"/>
                                    </HBox>
                                </VBox>

                                <HBox spacing="12" alignment="CENTER_LEFT">
                                    <Button fx:id="clearCacheButton" mnemonicParsing="false" onAction="#clearCache"
                                            text="Clear Local Cache"
                                            styleClass="btn-danger">
                                        <graphic>
                                            <FontIcon iconLiteral="bi-trash" iconSize="14"/>
                                        </graphic>
                                    </Button>
                                    <Button fx:id="openCacheFolderButton" mnemonicParsing="false"
                                            onAction="#openCacheFolder"
                                            text="Open Folder"
                                            styleClass="btn-gray">
                                        <graphic>
                                            <FontIcon iconLiteral="bi-folder2-open" iconSize="14"/>
                                        </graphic>
                                    </Button>
                                </HBox>
                            </VBox>
                        </VBox>
                    </ScrollPane>
                </content>
            </Tab>

            <!-- Tab 2: Network & Proxy -->
            <Tab text="Network &amp; Proxy" closable="false">
                <graphic>
                    <FontIcon iconLiteral="bi-hdd-network" iconSize="16" iconColor="#4a90e2"/>
                </graphic>
                <content>
                    <ScrollPane fitToWidth="true" styleClass="dashboard-scroll">
                        <VBox styleClass="settings-tab-content" spacing="20">
                            <Label text="Network &amp; Proxy Configuration"
                                   styleClass="settings-section-title"/>

                            <!-- Proxy Configuration -->
                            <VBox spacing="8">
                                <RadioButton fx:id="noProxy" mnemonicParsing="false" text="No Proxy">
                                    <toggleGroup>
                                        <ToggleGroup fx:id="proxy"/>
                                    </toggleGroup>
                                </RadioButton>
                                <RadioButton fx:id="systemProxy" mnemonicParsing="false" selected="true"
                                             text="Use System proxy settings" toggleGroup="$proxy"/>
                                <RadioButton fx:id="manualProxy" mnemonicParsing="false"
                                             text="Manual proxy configuration" toggleGroup="$proxy"/>
                            </VBox>

                            <!-- Manual Proxy Configuration -->
                            <GridPane hgap="12" vgap="10"
                                      styleClass="settings-section, settings-section-blue">
                                <Label text="Proxy Host Name:" GridPane.columnIndex="0" GridPane.rowIndex="0"/>
                                <TextField fx:id="httpProxyHost" promptText="host name" GridPane.columnIndex="1"
                                           GridPane.rowIndex="0"/>

                                <Label text="Proxy Port Number:" GridPane.columnIndex="0" GridPane.rowIndex="1"/>
                                <Spinner fx:id="portSpinner" editable="true" initialValue="8080" prefWidth="100"
                                         GridPane.columnIndex="1" GridPane.rowIndex="1"/>

                                <Label text="Username:" GridPane.columnIndex="0" GridPane.rowIndex="2"/>
                                <TextField fx:id="httpProxyUser" promptText="username" GridPane.columnIndex="1"
                                           GridPane.rowIndex="2"/>

                                <Label text="Password:" GridPane.columnIndex="0" GridPane.rowIndex="3"/>
                                <PasswordField fx:id="httpProxyPass" promptText="password" GridPane.columnIndex="1"
                                               GridPane.rowIndex="3"/>

                                <Label text="No Proxy for:" GridPane.columnIndex="0" GridPane.rowIndex="4"/>
                                <TextField fx:id="noProxyHost" promptText="e.g. *.domain.com, 192.168.*"
                                           GridPane.columnIndex="1" GridPane.rowIndex="4"/>

                                <columnConstraints>
                                    <ColumnConstraints hgrow="NEVER" minWidth="150.0"/>
                                    <ColumnConstraints hgrow="ALWAYS"/>
                                </columnConstraints>
                            </GridPane>

                            <!-- SSL Settings -->
                            <VBox spacing="8" styleClass="settings-section, settings-section-yellow">
                                <Label text="SSL Certificate Settings"
                                       styleClass="settings-section-subtitle"/>
                                <CheckBox fx:id="trustAllCerts" text="Trust all SSL certificates (âš  Security Warning)"/>
                                <Label text="Note: Only enable this for testing or corporate environments with self-signed certificates"
                                       styleClass="settings-section-hint"/>
                            </VBox>

                            <!-- Software Updates -->
                            <VBox spacing="8" styleClass="settings-section, settings-section-green">
                                <Label text="Software Updates"
                                       styleClass="settings-section-subtitle"/>
                                <CheckBox fx:id="checkForUpdatesOnStartup" text="Check for updates on startup"/>
                                <Label text="Checks GitHub for new releases when the application starts"
                                       styleClass="settings-section-hint"/>
                                <Button fx:id="checkForUpdatesButton" mnemonicParsing="false"
                                        onAction="#checkForUpdatesNow"
                                        text="Check for Updates Now"
                                        styleClass="btn-success-action">
                                    <graphic>
                                        <FontIcon iconLiteral="bi-arrow-repeat" iconSize="14"/>
                                    </graphic>
                                </Button>
                            </VBox>

                            <Button fx:id="checkConnection" mnemonicParsing="false" onAction="#performCheck"
                                    text="Test Connection"
                                    styleClass="btn-check-connection">
                                <graphic>
                                    <FontIcon iconLiteral="bi-plug-fill" iconSize="14"/>
                                </graphic>
                            </Button>
                        </VBox>
                    </ScrollPane>
                </content>
            </Tab>

            <!-- Tab 3: XML Editor -->
            <Tab text="XML Editor" closable="false">
                <graphic>
                    <FontIcon iconLiteral="bi-code-slash" iconSize="16" iconColor="#4a90e2"/>
                </graphic>
                <content>
                    <ScrollPane fitToWidth="true" styleClass="dashboard-scroll">
                        <VBox styleClass="settings-tab-content" spacing="20">
                            <Label text="XML Editor Configuration"
                                   styleClass="settings-section-title"/>

                            <!-- Formatting Settings -->
                            <VBox spacing="12" styleClass="settings-section, settings-section-blue">
                                <Label text="Formatting Settings"
                                       styleClass="settings-section-subtitle"/>
                                <GridPane hgap="12" vgap="10">
                                    <Label text="XML Indent Spaces:" GridPane.columnIndex="0" GridPane.rowIndex="0"/>
                                    <Spinner fx:id="xmlIndentSpaces" editable="true" initialValue="4" min="1" max="10"
                                             prefWidth="100" GridPane.columnIndex="1" GridPane.rowIndex="0"/>

                                    <CheckBox fx:id="autoFormatXmlAfterLoading" text="Autoformat XML after loading"
                                              GridPane.columnIndex="0" GridPane.rowIndex="1" GridPane.columnSpan="2"/>

                                    <CheckBox fx:id="schematronPrettyPrintOnLoad" text="Autoformat Schematron files after loading"
                                              GridPane.columnIndex="0" GridPane.rowIndex="2" GridPane.columnSpan="2"/>

                                    <columnConstraints>
                                        <ColumnConstraints hgrow="NEVER" minWidth="200.0"/>
                                        <ColumnConstraints hgrow="ALWAYS"/>
                                    </columnConstraints>
                                </GridPane>
                            </VBox>

                            <!-- Parser Settings -->
                            <VBox spacing="12" styleClass="settings-section, settings-section-yellow">
                                <Label text="XML Parser Settings"
                                       styleClass="settings-section-subtitle"/>
                                <GridPane hgap="12" vgap="10">
                                    <Label text="XSD Validation Parser:" GridPane.columnIndex="0" GridPane.rowIndex="0"/>
                                    <ComboBox fx:id="xmlParserComboBox" prefWidth="250" GridPane.columnIndex="1"
                                              GridPane.rowIndex="0"/>

                                    <Label text="Note: XSLT and XQuery operations always use Saxon"
                                           GridPane.columnIndex="0" GridPane.rowIndex="1" GridPane.columnSpan="2"
                                           styleClass="settings-section-hint"/>

                                    <columnConstraints>
                                        <ColumnConstraints hgrow="NEVER" minWidth="200.0"/>
                                        <ColumnConstraints hgrow="ALWAYS"/>
                                    </columnConstraints>
                                </GridPane>
                            </VBox>

                            <!-- Auto-Creation Settings -->
                            <VBox spacing="12" styleClass="settings-section, settings-section-green">
                                <Label text="Auto-Creation Settings"
                                       styleClass="settings-section-subtitle"/>
                                <VBox spacing="8">
                                    <CheckBox fx:id="createAllChildNodes" text="Create all child nodes (not only mandatory)"/>
                                    <CheckBox fx:id="fillNodesWithSampleValues" text="Fill nodes with sample values"/>
                                </VBox>
                            </VBox>
                        </VBox>
                    </ScrollPane>
                </content>
            </Tab>

            <!-- Tab 4: XSD Editor -->
            <Tab text="XSD Editor" closable="false">
                <graphic>
                    <FontIcon iconLiteral="bi-file-earmark-code" iconSize="16" iconColor="#4a90e2"/>
                </graphic>
                <content>
                    <ScrollPane fitToWidth="true" styleClass="dashboard-scroll">
                        <VBox styleClass="settings-tab-content" spacing="20">
                            <Label text="XSD Editor Configuration"
                                   styleClass="settings-section-title"/>

                            <!-- Auto-save settings -->
                            <VBox spacing="12" styleClass="settings-section, settings-section-blue">
                                <Label text="Auto-Save Settings"
                                       styleClass="settings-section-subtitle"/>
                                <VBox spacing="8">
                                    <CheckBox fx:id="xsdAutoSaveEnabled" text="Enable Auto-Save"/>
                                    <HBox spacing="12" alignment="CENTER_LEFT">
                                        <Label text="Auto-Save Interval (minutes):"/>
                                        <Spinner fx:id="xsdAutoSaveInterval" editable="true" initialValue="5" min="1" max="60" prefWidth="100"/>
                                    </HBox>
                                </VBox>
                            </VBox>

                            <!-- Backup settings -->
                            <VBox spacing="12" styleClass="settings-section, settings-section-yellow">
                                <Label text="Backup Settings"
                                       styleClass="settings-section-subtitle"/>
                                <VBox spacing="8">
                                    <CheckBox fx:id="xsdBackupEnabled" text="Create Backup Files on Save"/>
                                    <HBox spacing="12" alignment="CENTER_LEFT">
                                        <Label text="Number of Backup Versions:"/>
                                        <Spinner fx:id="xsdBackupVersions" editable="true" initialValue="3" min="1" max="10" prefWidth="100"/>
                                    </HBox>
                                </VBox>

                                <Separator/>

                                <Label text="Backup Location"
                                       styleClass="settings-subsection-title"/>
                                <VBox spacing="8">
                                    <RadioButton fx:id="backupSameDirectory" text="Same directory as original file">
                                        <toggleGroup>
                                            <ToggleGroup fx:id="backupLocation"/>
                                        </toggleGroup>
                                    </RadioButton>
                                    <RadioButton fx:id="backupSeparateDirectory" text="Separate backup directory:"
                                                 toggleGroup="$backupLocation"/>
                                    <HBox spacing="8" alignment="CENTER_LEFT" style="-fx-padding: 0 0 0 24">
                                        <TextField fx:id="backupDirectoryPath" prefWidth="350"
                                                   promptText="~/.freexmltoolkit/backups" HBox.hgrow="ALWAYS"
                                                   styleClass="settings-text-field"/>
                                        <Button fx:id="browseBackupDirectory" onAction="#browseBackupDirectory" text="Browse..."
                                                styleClass="btn-gray">
                                            <graphic>
                                                <FontIcon iconLiteral="bi-folder2-open" iconSize="14"/>
                                            </graphic>
                                        </Button>
                                    </HBox>
                                    <Label text="When using a separate directory, backups are stored centrally instead of next to the original file"
                                           styleClass="settings-section-hint-indented"/>
                                </VBox>
                            </VBox>

                            <!-- Formatting settings -->
                            <VBox spacing="12" styleClass="settings-section, settings-section-green">
                                <Label text="Formatting"
                                       styleClass="settings-section-subtitle"/>
                                <CheckBox fx:id="xsdPrettyPrintOnSave"
                                          text="Pretty-Print on Save (uses XML indent settings)"/>
                            </VBox>

                            <!-- Serialization Order settings -->
                            <VBox spacing="12" styleClass="settings-section, settings-section-cyan">
                                <Label text="Serialization Order"
                                       styleClass="settings-section-subtitle"/>
                                <Label text="How elements are ordered when saving XSD files"
                                       styleClass="settings-section-hint"/>
                                <VBox spacing="8">
                                    <RadioButton fx:id="sortTypeBeforeName" text="Type before Name">
                                        <toggleGroup>
                                            <ToggleGroup fx:id="xsdSortOrder"/>
                                        </toggleGroup>
                                    </RadioButton>
                                    <Label text="Sort by XSD construct type first (attributeGroup, complexType, etc.), then by name"
                                           styleClass="settings-section-hint" style="-fx-padding: 0 0 0 20"/>
                                    <RadioButton fx:id="sortNameBeforeType" text="Name before Type" toggleGroup="$xsdSortOrder"/>
                                    <Label text="Sort elements purely by name (alphabetically)"
                                           styleClass="settings-section-hint" style="-fx-padding: 0 0 0 20"/>
                                </VBox>
                                <Label text="Note: xs:import and xs:include are always serialized first, followed by global elements"
                                       styleClass="settings-section-hint" style="-fx-padding: 8 0 0 0"/>
                            </VBox>
                        </VBox>
                    </ScrollPane>
                </content>
            </Tab>

            <!-- Tab 5: Favorites -->
            <Tab text="Favorites" closable="false">
                <graphic>
                    <FontIcon iconLiteral="bi-star-fill" iconSize="16" iconColor="#ffc107"/>
                </graphic>
                <content>
                    <ScrollPane fitToWidth="true" styleClass="dashboard-scroll">
                        <VBox styleClass="settings-tab-content" spacing="20">
                            <Label text="Favorites Management"
                                   styleClass="settings-section-title"/>

                            <!-- Favorites List -->
                            <VBox spacing="12">
                                <Label text="Manage Saved Favorites"
                                       styleClass="settings-section-subtitle"/>
                                <TableView fx:id="favoritesTable" prefHeight="300">
                                    <columns>
                                        <TableColumn fx:id="nameColumn" text="Name" prefWidth="200"/>
                                        <TableColumn fx:id="categoryColumn" text="Category" prefWidth="150"/>
                                        <TableColumn fx:id="fileTypeColumn" text="Type" prefWidth="80"/>
                                        <TableColumn fx:id="pathColumn" text="Path" prefWidth="300"/>
                                    </columns>
                                </TableView>

                                <!-- Favorites Actions -->
                                <HBox spacing="8" alignment="CENTER_LEFT"
                                      styleClass="favorites-action-bar">
                                    <Button fx:id="openFavoriteButton" onAction="#openSelectedFavorite" text="Open"
                                            styleClass="btn-info-action">
                                        <graphic>
                                            <FontIcon iconLiteral="bi-folder2-open" iconSize="14"/>
                                        </graphic>
                                    </Button>
                                    <Button fx:id="editFavoriteButton" onAction="#editSelectedFavorite" text="Edit"
                                            styleClass="btn-gray">
                                        <graphic>
                                            <FontIcon iconLiteral="bi-pencil" iconSize="14"/>
                                        </graphic>
                                    </Button>
                                    <Button fx:id="removeFavoriteButton" onAction="#removeSelectedFavorite" text="Remove"
                                            styleClass="btn-danger">
                                        <graphic>
                                            <FontIcon iconLiteral="bi-trash" iconSize="14"/>
                                        </graphic>
                                    </Button>
                                    <Button fx:id="removeNonExistentButton" onAction="#removeNonExistentFavorites"
                                            text="Cleanup"
                                            styleClass="btn-warning-action">
                                        <graphic>
                                            <FontIcon iconLiteral="bi-x-circle" iconSize="14"/>
                                        </graphic>
                                    </Button>
                                </HBox>

                                <!-- Category Management -->
                                <VBox spacing="8" styleClass="category-management-section">
                                    <Label text="Category Management"
                                           styleClass="settings-section-subtitle"/>
                                    <HBox spacing="8" alignment="CENTER_LEFT">
                                        <TextField fx:id="newCategoryField" promptText="Enter new category name"
                                                   HBox.hgrow="ALWAYS"
                                                   styleClass="settings-text-field"/>
                                        <Button fx:id="createCategoryButton" onAction="#createNewCategory"
                                                text="Create"
                                                styleClass="btn-success-action">
                                            <graphic>
                                                <FontIcon iconLiteral="bi-plus-circle" iconSize="14"/>
                                            </graphic>
                                        </Button>
                                    </HBox>
                                    <Label text="Note: Categories with favorites cannot be deleted"
                                           styleClass="settings-section-hint"/>
                                </VBox>
                            </VBox>
                        </VBox>
                    </ScrollPane>
                </content>
            </Tab>

        </TabPane>

        <!-- Action Buttons -->
        <HBox spacing="12" alignment="CENTER" styleClass="settings-action-bar">
            <Button mnemonicParsing="false" onAction="#performSave" text="Save Settings"
                    styleClass="btn-save">
                <graphic>
                    <FontIcon iconLiteral="bi-save" iconSize="16"/>
                </graphic>
            </Button>
            <Button mnemonicParsing="false" onAction="#loadCurrentSettings" text="Cancel"
                    styleClass="btn-cancel">
                <graphic>
                    <FontIcon iconLiteral="bi-x-circle" iconSize="16"/>
                </graphic>
            </Button>
        </HBox>

    </VBox>
</AnchorPane>

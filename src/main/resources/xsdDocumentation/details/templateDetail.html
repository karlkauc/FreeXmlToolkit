<!--
  ~ FreeXMLToolkit - Universal Toolkit for XML
  ~ Copyright (c) Karl Kauc 2024.
  ~
  ~  Licensed under the Apache License, Version 2.0 (the "License");
  ~  you may not use this file except in compliance with the License.
  ~  You may obtain a copy of the License at
  ~
  ~      http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~  Unless required by applicable law or agreed to in writing, software
  ~  distributed under the License is distributed on an "AS IS" BASIS,
  ~  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~  See the License for the specific language governing permissions and
  ~  limitations under the License.
  ~
  -->

<!DOCTYPE html>
<html lang="en" class="bg-slate-50" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title th:text="'Detail: ' + ${element.elementName}">XSD Documentation</title>

    <!-- Generated Tailwind CSS -->
    <link href="../assets/freexmltoolkit-docs.css" rel="stylesheet">

    <!-- PrismJS for Syntax Highlighting -->
    <link href="../assets/prism.css" rel="stylesheet"/>

    <!-- Custom styles for details/summary -->
    <style>
        /* Use custom marker indicator instead of default */
        summary::marker,
        summary::-webkit-details-marker {
            display: none;
        }
        /* Ensure keyboard focus is visible on summary elements */
        summary:focus {
            outline: 2px solid #0ea5e9;
            outline-offset: 2px;
        }
    </style>
</head>
<body class="font-sans text-slate-800" data-root-path=".." data-search-index-path="../search_index.json">

<!-- Skip link for keyboard navigation -->
<a href="#main-content" class="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 focus:z-50 focus:bg-white focus:px-4 focus:py-2 focus:rounded-md focus:shadow-lg focus:text-sky-600">
    Skip to main content
</a>

<!-- Modern navigation with shadow and clear spacing -->
<nav class="bg-white/80 backdrop-blur-md shadow-sm sticky top-0 z-10 border-b border-slate-200">
    <div class="container mx-auto px-4">
        <div class="flex justify-between items-center h-16">
            <!-- Left navigation group -->
            <div class="hidden md:flex items-baseline space-x-6">
                <a href="../index.html" class="px-3 py-2 rounded-md text-sm font-medium text-sky-600 bg-sky-100"
                   aria-current="page">Home</a>
                <a href="../complexTypes.html"
                   class="px-3 py-2 rounded-md text-sm font-medium text-slate-700 hover:bg-slate-100 hover:text-slate-900">Complex
                    Types</a>
                <a href="../simpleTypes.html"
                   class="px-3 py-2 rounded-md text-sm font-medium text-slate-700 hover:bg-slate-100 hover:text-slate-900">Simple
                    Types</a>
                <a href="../dataDictionary.html"
                   class="px-3 py-2 rounded-md text-sm font-medium text-slate-700 hover:bg-slate-100 hover:text-slate-900">Data
                    Dictionary</a>
                <a href="../schema-svg.html"
                   class="px-3 py-2 rounded-md text-sm font-medium text-slate-700 hover:bg-slate-100 hover:text-slate-900">SVG</a>
            </div>
            <!-- Search Bar -->
            <div class="relative flex-1 max-w-md mx-4">
                <label for="search-input" class="sr-only">Search documentation</label>
                <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3" aria-hidden="true">
                    <svg class="h-5 w-5 text-slate-400" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd"
                              d="M9 3.5a5.5 5.5 0 100 11 5.5 5.5 0 000-11zM2 9a7 7 0 1112.452 4.391l3.328 3.329a.75.75 0 11-1.06 1.06l-3.329-3.328A7 7 0 012 9z"
                              clip-rule="evenodd"/>
                    </svg>
                </div>
                <input type="search" id="search-input" placeholder="Loading search index..." disabled
                       class="w-full pl-3 pr-10 py-2 text-sm leading-tight text-slate-700 border border-slate-300 rounded-md shadow-sm appearance-none focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-sky-500 disabled:bg-slate-50 disabled:cursor-not-allowed">
                <div id="search-results" role="listbox" aria-live="polite" aria-label="Search results"
                     class="absolute hidden w-full mt-1 bg-white border border-slate-200 rounded-md shadow-lg z-20 max-h-96 overflow-y-auto">
                    <!-- Search results will be injected here -->
                </div>
            </div>
            <!-- Right navigation group (Language Switcher + GitHub Link) -->
            <div class="hidden md:flex items-center space-x-4">
                <!-- Language Switcher -->
                <div class="flex items-center space-x-2">
                    <label for="lang-switcher-nav" class="text-sm text-slate-600">Language:</label>
                    <select id="lang-switcher-nav"
                            class="lang-switcher text-sm border border-slate-300 rounded-md px-2 py-1 bg-white focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-sky-500">
                        <option value="default">Default (no lang)</option>
                        <!-- Options populated dynamically by language-switcher.js -->
                    </select>
                </div>
                <!-- GitHub Link -->
                <a href="https://github.com/karlkauc/FreeXmlToolkit" target="_blank"
                   class="flex items-center space-x-2 text-slate-700 font-bold">
                    <img src="../assets/logo.png" alt="FreeXmlToolkit Logo" class="h-8 w-8"/>
                    <span>FreeXmlToolKit</span>
                </a>
            </div>
        </div>
    </div>
</nav>

<!-- Main content -->
<main id="main-content" class="container mx-auto px-4 py-8 md:py-12">

    <!-- Breadcrumb navigation: Now uses a pre-formatted HTML string for simplicity and correctness. -->
    <nav aria-label="breadcrumb" class="mb-6 text-sm" th:if="${breadCrumbs != null}"
         th:utext="${breadCrumbs}">
    </nav>

    <!-- Central detail card -->
    <div class="bg-white rounded-xl shadow-md border border-slate-200 overflow-hidden">
        <!-- Card header with element name and XPath -->
        <header class="p-6 border-b border-slate-200 bg-slate-50">
            <h1 class="text-2xl font-bold text-slate-900" th:text="${element.elementName}">ElementName</h1>
            <!-- Container for XPath and copy buttons -->
            <div class="flex items-center space-x-2 mt-1">
                <p class="text-sm text-slate-600 font-mono" th:text="${this.getCleanXPath(element)}">/path/to/element</p>

                <!-- Button to copy the XPath -->
                <button aria-label="Copy XPath" th:attr="data-xpath=${this.getCleanXPath(element)}"
                        onclick="copyXPath(this)"
                        class="relative group p-1 rounded-md text-slate-400 hover:bg-slate-200 hover:text-slate-600 transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24"
                         stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round"
                              d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
                    </svg>
                    <span class="tooltip-text absolute -top-8 left-1/2 -translate-x-1/2 w-max px-2 py-1 bg-slate-800 text-white text-xs rounded-md opacity-0 group-hover:opacity-100 transition-opacity">
                        Copy XPath
                    </span>
                </button>

                <!-- Button to copy the Permalink -->
                <button aria-label="Copy Permalink" th:attr="data-xpath=${this.getCleanXPath(element)}"
                        onclick="copyPermalink(this)"
                        class="relative group p-1 rounded-md text-slate-400 hover:bg-slate-200 hover:text-slate-600 transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1" />
                    </svg>
                    <span class="tooltip-text absolute -top-8 left-1/2 -translate-x-1/2 w-max px-2 py-1 bg-slate-800 text-white text-xs rounded-md opacity-0 group-hover:opacity-100 transition-opacity">
                        Copy Permalink
                    </span>
                </button>
            </div>
        </header>

        <!-- Card body with all detail sections -->
        <div class="p-6 md:p-8 space-y-10">

            <!-- Section: Diagram -->
            <section>
                <h2 class="text-lg font-semibold text-slate-800 mb-3">Diagram</h2>
                <div class="p-4 border border-slate-200 rounded-lg bg-slate-50 overflow-x-auto">
                    <!-- Thymeleaf switch to differentiate between SVG, PNG and JPG -->
                    <div th:switch="${diagramType}">
                        <!-- Case 1: If the type is 'SVG', insert the SVG code directly -->
                        <div th:case="'SVG'" role="img" aria-label="Diagram showing the structure of this element" th:utext="${diagramContent}">
                            <!-- The raw SVG string is inserted here by Thymeleaf -->
                        </div>
                        <!-- Case 2: If the type is 'PNG', create a normal image tag -->
                        <div th:case="'PNG'" style="float:left;">
                            <img th:src="${'../' + diagramContent}" alt="Diagram of the element" class="mx-auto"/>
                        </div>
                        <!-- Case 3: If the type is 'JPG', create a normal image tag -->
                        <div th:case="'JPG'" style="float:left;">
                            <img th:src="${'../' + diagramContent}" alt="Diagram of the element" class="mx-auto"/>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section: Documentation (Multi-Language Support) -->
            <section th:if="${documentation != null and not #maps.isEmpty(documentation)}"
                     class="documentation-section">
                <h2 class="text-lg font-semibold text-slate-800 mb-3">Documentation</h2>
                <div class="bg-slate-100/75 p-4 rounded-md space-y-2">
                    <!-- Each language as separate div with data-lang attribute -->
                    <div th:each="doc: ${documentation}"
                         class="doc-content"
                         th:attr="data-lang=${doc.key}"
                         th:hidden="${doc.key != 'default'}">
                        <strong th:if="${doc.key != 'default'}"
                                class="doc-lang-label inline-block px-2 py-0.5 rounded text-xs font-semibold mb-2"
                                th:classappend="${doc.key == 'en' ? 'bg-blue-100 text-blue-800' : (doc.key == 'de' ? 'bg-amber-100 text-amber-800' : (doc.key == 'fr' ? 'bg-pink-100 text-pink-800' : 'bg-slate-200 text-slate-700'))}"
                                th:text="${#strings.toUpperCase(doc.key)}">LANG</strong>
                        <p class="text-slate-600" th:utext="${doc.value}">VALUE</p>
                    </div>
                </div>
            </section>

            <!-- Section for Javadoc-style annotations -->
            <section th:if="${element.xsdDocInfo != null and element.xsdDocInfo.hasData()}" class="space-y-6">
                <!-- Deprecated Warning Box -->
                <div th:if="${element.xsdDocInfo.deprecated != null}"
                     class="p-4 border-l-4 border-red-500 bg-red-50 rounded-r-lg">
                    <div class="flex items-start">
                        <div class="flex-shrink-0">
                            <svg class="h-5 w-5 text-red-400" viewBox="0 0 20 20" fill="currentColor"
                                 aria-hidden="true">
                                <path fill-rule="evenodd"
                                      d="M8.485 2.495c.673-1.167 2.357-1.167 3.03 0l6.28 10.875c.673 1.167-.17 2.625-1.516 2.625H3.72c-1.347 0-2.189-1.458-1.515-2.625L8.485 2.495zM10 5a.75.75 0 01.75.75v3.5a.75.75 0 01-1.5 0v-3.5A.75.75 0 0110 5zm0 9a1 1 0 100-2 1 1 0 000 2z"
                                      clip-rule="evenodd"/>
                            </svg>
                        </div>
                        <div class="ml-3">
                            <h3 class="text-sm font-bold text-red-800">Deprecated</h3>
                            <div class="mt-1 text-sm text-red-700 prose prose-sm max-w-none"
                                 th:utext="${this.parseJavadocLinks(element.xsdDocInfo.deprecated)}">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Grid for other Javadoc info like @since and @see -->
                <dl class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-8 gap-y-5">
                    <!-- Since -->
                    <div th:if="${element.xsdDocInfo.since != null}" class="flex flex-col">
                        <dt class="text-sm font-medium text-slate-500">Since</dt>
                        <dd class="mt-1 text-slate-900 font-mono" th:text="${element.xsdDocInfo.since}">1.0.0</dd>
                    </div>

                    <!-- See Also -->
                    <div th:if="${!#lists.isEmpty(element.xsdDocInfo.see)}" class="flex flex-col md:col-span-full">
                        <dt class="text-sm font-medium text-slate-500">See Also</dt>
                        <dd class="mt-1 text-slate-900">
                            <ul class="list-disc list-inside space-y-1">
                                <li th:each="seeItem : ${element.xsdDocInfo.see}"
                                    th:utext="${this.parseJavadocLinks(seeItem)}">
                                </li>
                            </ul>
                        </dd>
                    </div>
                </dl>
            </section>

            <!-- Section: Properties -->
            <section>
                <h2 class="text-lg font-semibold text-slate-800 mb-3">Properties</h2>
                <dl class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-8 gap-y-5">
                    <div class="flex flex-col">
                        <dt class="text-sm font-medium text-slate-500">Type</dt>
                        <dd class="mt-1 text-slate-900 font-mono">
                            <span th:if="${element.isListType()}" class="inline-flex items-center">
                                <span class="px-2 py-0.5 rounded text-xs font-semibold bg-indigo-100 text-indigo-800 border border-indigo-300 mr-2">List</span>
                                <span th:text="${'List of ' + element.listItemType}">List of xs:int</span>
                            </span>
                            <span th:if="${element.isUnionType()}" class="inline-flex items-center">
                                <span class="px-2 py-0.5 rounded text-xs font-semibold bg-pink-100 text-pink-800 border border-pink-300 mr-2">Union</span>
                                <span th:text="${'Union of ' + #strings.listJoin(element.unionMemberTypes, ' | ')}">Union of xs:string | xs:int</span>
                            </span>
                            <span th:if="${!element.isListType() and !element.isUnionType()}" th:text="${element.elementType}">element-type</span>
                        </dd>
                    </div>
                    <div class="flex flex-col">
                        <dt class="text-sm font-medium text-slate-500">Cardinality</dt>
                        <dd class="mt-1 text-slate-900 font-mono"
                            th:text="${this.getCardinality(element)}">
                            1..1
                        </dd>
                    </div>
                    <div class="flex flex-col">
                        <dt class="text-sm font-medium text-slate-500">Namespace</dt>
                        <dd class="mt-1 text-slate-900" th:utext="${namespace}">namespace</dd>
                    </div>
                    <div class="flex flex-col">
                        <dt class="text-sm font-medium text-slate-500">Level</dt>
                        <dd class="mt-1 text-slate-900" th:text="${element.level}">1</dd>
                    </div>
                    <div class="flex flex-col md:col-span-2" th:if="${sampleData != null and sampleData != '...'}">
                        <dt class="text-sm font-medium text-slate-500">Sample Data</dt>
                        <dd class="mt-1 text-slate-900 bg-slate-100 p-2 rounded-md font-mono text-sm"
                            th:text="${sampleData}">Sample Data
                        </dd>
                    </div>
                    <div class="flex flex-col md:col-span-full"
                         th:if="${element.xsdRestrictionString != null and not #strings.isEmpty(element.xsdRestrictionString)}">
                        <dt class="text-sm font-medium text-slate-500">Restrictions</dt>
                        <dd class="mt-1 text-slate-900 bg-slate-100 p-2 rounded-md font-mono text-sm"
                            th:utext="${element.xsdRestrictionString}">RESTRICTIONS
                        </dd>
                    </div>
                </dl>
            </section>

            <!-- Section: Child Elements & Attributes -->
            <section th:if="${flattenedChildren != null and not #lists.isEmpty(flattenedChildren)}">
                <h2 class="text-lg font-semibold text-slate-800 mb-3">Child Elements &amp; Attributes</h2>
                <div class="overflow-x-auto border border-slate-200 rounded-lg">
                    <table class="w-full text-left">
                        <caption class="sr-only">Child elements and attributes of this element</caption>
                        <thead class="bg-slate-50 border-b border-slate-200 text-sm">
                        <tr>
                            <th scope="col" class="px-4 py-3 font-semibold text-slate-900">Name (XPath)</th>
                            <th scope="col" class="px-4 py-3 font-semibold text-slate-900">Type</th>
                            <th scope="col" class="px-4 py-3 font-semibold text-slate-900">Documentation</th>
                            <th scope="col" class="px-4 py-3 font-semibold text-slate-900">Sample Data</th>
                        </tr>
                        </thead>
                        <tbody class="divide-y divide-slate-200 text-sm">
                        <tr th:each="childXpath: ${flattenedChildren}">
                            <td class="px-4 py-3 font-mono">
                                <div class="flex items-center gap-2">
                                    <a th:href="${this.getPageName(childXpath)}"
                                       th:title="${this.getCleanXPath(childXpath)}"
                                       class="text-sky-600 hover:text-sky-800 hover:underline">
                                        <span th:with="cleanXpath=${this.getCleanXPath(childXpath)}, pathParts=${#strings.arraySplit(cleanXpath, '/')}"
                                              th:text="${(#arrays.length(pathParts) > 3) ? ('/' + pathParts[1] + '/.../' + pathParts[#arrays.length(pathParts) - 1]) : cleanXpath}">
                                        </span>
                                    </a>
                                    <!-- Compositor badge -->
                                    <span th:if="${this.getChildCompositorType(childXpath) == 'CHOICE'}"
                                          class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-amber-100 text-amber-800"
                                          title="This element is part of a choice group - only one option from the group should be selected">
                                        choice
                                    </span>
                                    <span th:if="${this.getChildCompositorType(childXpath) == 'SEQUENCE'}"
                                          class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800"
                                          title="This element is part of a sequence">
                                        sequence
                                    </span>
                                    <span th:if="${this.getChildCompositorType(childXpath) == 'ALL'}"
                                          class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800"
                                          title="This element is part of an 'all' group - elements can appear in any order">
                                        all
                                    </span>
                                </div>
                            </td>

                            <td class="px-4 py-3 font-mono">
                                <a th:if="${this.isChildTypeLinkable(childXpath)}"
                                   th:href="${this.getChildTypePageName(childXpath)}"
                                   th:text="${this.getChildType(childXpath)}"
                                   class="text-sky-600 hover:text-sky-800 hover:underline">
                                </a>
                                <span th:unless="${this.isChildTypeLinkable(childXpath)}"
                                      th:text="${this.getChildType(childXpath)}">
                                </span>
                            </td>

                            <td class="px-4 py-3 text-slate-600 prose prose-sm max-w-md"
                                th:utext="${this.getChildDocumentation(childXpath)}">
                            </td>
                            <td class="px-4 py-3 font-mono text-slate-600"
                                th:text="${this.getChildSampleData(childXpath)}">
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Section: Additional Information (for generic appinfo tags) -->
            <section th:if="${appInfos != null and not #lists.isEmpty(appInfos)}">
                <h2 class="text-lg font-semibold text-slate-800 mb-3">Additional Information</h2>
                <div class="space-y-2">
                    <div th:each="appInfo: ${appInfos}" th:utext="${appInfo}"
                         class="p-3 bg-slate-100 rounded-md text-sm text-slate-700 font-mono">
                    </div>
                </div>
            </section>

            <!-- Section: Identity Constraints (XSD 1.0) -->
            <section th:if="${element.identityConstraints != null and not #lists.isEmpty(element.identityConstraints)}">
                <h2 class="text-lg font-semibold text-slate-800 mb-4">Identity Constraints</h2>
                <div class="space-y-6">
                    <div th:each="constraint: ${element.identityConstraints}"
                         class="bg-slate-50 border-2 border-slate-200 rounded-lg p-5 shadow-sm">
                        <div class="flex items-center gap-3 mb-4 pb-3 border-b border-slate-300">
                            <!-- Constraint type badge -->
                            <span th:if="${constraint.type.name() == 'KEY'}"
                                  class="inline-flex items-center px-3 py-1 rounded-md text-xs font-semibold bg-blue-100 text-blue-800 border border-blue-300">
                                Key
                            </span>
                            <span th:if="${constraint.type.name() == 'KEYREF'}"
                                  class="inline-flex items-center px-3 py-1 rounded-md text-xs font-semibold bg-purple-100 text-purple-800 border border-purple-300">
                                Key Reference
                            </span>
                            <span th:if="${constraint.type.name() == 'UNIQUE'}"
                                  class="inline-flex items-center px-3 py-1 rounded-md text-xs font-semibold bg-green-100 text-green-800 border border-green-300">
                                Unique
                            </span>
                            <span class="font-mono font-bold text-lg text-slate-900" th:text="${constraint.name}">constraintName</span>
                        </div>

                        <dl class="grid grid-cols-1 gap-4 text-sm">
                            <!-- Selector -->
                            <div class="space-y-2">
                                <dt class="font-semibold text-slate-600 uppercase text-xs tracking-wide">Selector</dt>
                                <dd class="font-mono text-sm text-slate-900 bg-white px-4 py-3 rounded-md border border-slate-300 shadow-sm"
                                    th:text="${constraint.selector}">xpath</dd>
                            </div>

                            <!-- Fields -->
                            <div th:if="${constraint.fields != null and not #lists.isEmpty(constraint.fields)}" class="space-y-2">
                                <dt class="font-semibold text-slate-600 uppercase text-xs tracking-wide">Field(s)</dt>
                                <dd class="space-y-2">
                                    <div th:each="field: ${constraint.fields}"
                                         class="font-mono text-sm text-slate-900 bg-white px-4 py-3 rounded-md border border-slate-300 shadow-sm"
                                         th:text="${field}">field xpath</div>
                                </dd>
                            </div>

                            <!-- Refer (for keyref) -->
                            <div th:if="${constraint.refer != null}" class="space-y-2">
                                <dt class="font-semibold text-slate-600 uppercase text-xs tracking-wide">Refers to</dt>
                                <dd class="font-mono text-sm text-slate-900 bg-white px-4 py-3 rounded-md border border-slate-300 shadow-sm"
                                    th:text="${constraint.refer}">referenced key</dd>
                            </div>

                            <!-- Documentation -->
                            <div th:if="${constraint.documentation != null and not #strings.isEmpty(constraint.documentation)}" class="space-y-2">
                                <dt class="font-semibold text-slate-600 uppercase text-xs tracking-wide">Documentation</dt>
                                <dd class="text-slate-700 bg-white px-4 py-3 rounded-md border border-slate-300 prose prose-sm max-w-none"
                                    th:text="${constraint.documentation}">documentation</dd>
                            </div>
                        </dl>
                    </div>
                </div>
            </section>

            <!-- Section: Assertions (XSD 1.1) -->
            <section th:if="${element.assertions != null and not #lists.isEmpty(element.assertions)}">
                <h2 class="text-lg font-semibold text-slate-800 mb-4">Assertions (XSD 1.1)</h2>
                <div class="space-y-6">
                    <div th:each="assertion: ${element.assertions}"
                         class="bg-amber-50 border-2 border-amber-200 rounded-lg p-5 shadow-sm">
                        <div class="flex items-center gap-3 mb-4 pb-3 border-b border-amber-300">
                            <!-- Assertion type badge -->
                            <span th:if="${assertion.type.name() == 'ASSERT'}"
                                  class="inline-flex items-center px-3 py-1 rounded-md text-xs font-semibold bg-amber-100 text-amber-800 border border-amber-400">
                                Assert (complexType)
                            </span>
                            <span th:if="${assertion.type.name() == 'ASSERTION'}"
                                  class="inline-flex items-center px-3 py-1 rounded-md text-xs font-semibold bg-orange-100 text-orange-800 border border-orange-400">
                                Assertion (simpleType)
                            </span>
                        </div>

                        <dl class="grid grid-cols-1 gap-4 text-sm">
                            <!-- Test expression -->
                            <div class="space-y-2">
                                <dt class="font-semibold text-amber-900 uppercase text-xs tracking-wide">Test (XPath 2.0)</dt>
                                <dd class="font-mono text-sm text-slate-900 bg-white px-4 py-3 rounded-md border border-amber-300 shadow-sm"
                                    th:text="${assertion.test}">xpath expression</dd>
                            </div>

                            <!-- XPath default namespace -->
                            <div th:if="${assertion.xpathDefaultNamespace != null and not #strings.isEmpty(assertion.xpathDefaultNamespace)}" class="space-y-2">
                                <dt class="font-semibold text-amber-900 uppercase text-xs tracking-wide">XPath Default Namespace</dt>
                                <dd class="font-mono text-sm text-slate-700 bg-white px-4 py-3 rounded-md border border-amber-300"
                                    th:text="${assertion.xpathDefaultNamespace}">namespace</dd>
                            </div>

                            <!-- Documentation -->
                            <div th:if="${assertion.documentation != null and not #strings.isEmpty(assertion.documentation)}" class="space-y-2">
                                <dt class="font-semibold text-amber-900 uppercase text-xs tracking-wide">Documentation</dt>
                                <dd class="text-slate-700 bg-white px-4 py-3 rounded-md border border-amber-300 prose prose-sm max-w-none"
                                    th:text="${assertion.documentation}">documentation</dd>
                            </div>
                        </dl>
                    </div>
                </div>
            </section>

            <!-- Section: Type Alternatives (XSD 1.1) -->
            <section th:if="${element.typeAlternatives != null and not #lists.isEmpty(element.typeAlternatives)}">
                <h2 class="text-lg font-semibold text-slate-800 mb-4">Type Alternatives (XSD 1.1)</h2>
                <div class="space-y-6">
                    <div th:each="alternative: ${element.typeAlternatives}"
                         class="bg-purple-50 border-2 border-purple-200 rounded-lg p-5 shadow-sm">
                        <div class="flex items-center gap-3 mb-4 pb-3 border-b border-purple-300">
                            <!-- Default vs conditional badge -->
                            <span th:if="${alternative.test == null or #strings.isEmpty(alternative.test)}"
                                  class="inline-flex items-center px-3 py-1 rounded-md text-xs font-semibold bg-slate-100 text-slate-800 border border-slate-300">
                                Default (otherwise)
                            </span>
                            <span th:unless="${alternative.test == null or #strings.isEmpty(alternative.test)}"
                                  class="inline-flex items-center px-3 py-1 rounded-md text-xs font-semibold bg-purple-100 text-purple-800 border border-purple-400">
                                Conditional
                            </span>
                            <span class="font-mono font-bold text-lg text-slate-900" th:text="${alternative.type}">TypeName</span>
                        </div>

                        <dl class="grid grid-cols-1 gap-4 text-sm">
                            <!-- Test condition (only for conditional alternatives) -->
                            <div th:if="${alternative.test != null and not #strings.isEmpty(alternative.test)}" class="space-y-2">
                                <dt class="font-semibold text-purple-900 uppercase text-xs tracking-wide">When (XPath 2.0)</dt>
                                <dd class="font-mono text-sm text-slate-900 bg-white px-4 py-3 rounded-md border border-purple-300 shadow-sm"
                                    th:text="${alternative.test}">xpath expression</dd>
                            </div>

                            <!-- XPath default namespace -->
                            <div th:if="${alternative.xpathDefaultNamespace != null and not #strings.isEmpty(alternative.xpathDefaultNamespace)}" class="space-y-2">
                                <dt class="font-semibold text-purple-900 uppercase text-xs tracking-wide">XPath Default Namespace</dt>
                                <dd class="font-mono text-sm text-slate-700 bg-white px-4 py-3 rounded-md border border-purple-300"
                                    th:text="${alternative.xpathDefaultNamespace}">namespace</dd>
                            </div>

                            <!-- Documentation -->
                            <div th:if="${alternative.documentation != null and not #strings.isEmpty(alternative.documentation)}" class="space-y-2">
                                <dt class="font-semibold text-purple-900 uppercase text-xs tracking-wide">Documentation</dt>
                                <dd class="text-slate-700 bg-white px-4 py-3 rounded-md border border-purple-300 prose prose-sm max-w-none"
                                    th:text="${alternative.documentation}">documentation</dd>
                            </div>
                        </dl>
                    </div>
                </div>
            </section>

            <!-- Section: Wildcards (xs:any, xs:anyAttribute) -->
            <section th:if="${element.wildcards != null and not #lists.isEmpty(element.wildcards)}">
                <h2 class="text-lg font-semibold text-slate-800 mb-4">Wildcards</h2>
                <div class="space-y-6">
                    <div th:each="wildcard: ${element.wildcards}"
                         class="bg-teal-50 border-2 border-teal-200 rounded-lg p-5 shadow-sm">
                        <div class="flex items-center gap-3 mb-4 pb-3 border-b border-teal-300">
                            <!-- Wildcard type badge -->
                            <span th:if="${wildcard.type.name() == 'ANY'}"
                                  class="inline-flex items-center px-3 py-1 rounded-md text-xs font-semibold bg-teal-100 text-teal-800 border border-teal-400">
                                Any Element
                            </span>
                            <span th:if="${wildcard.type.name() == 'ANY_ATTRIBUTE'}"
                                  class="inline-flex items-center px-3 py-1 rounded-md text-xs font-semibold bg-cyan-100 text-cyan-800 border border-cyan-400">
                                Any Attribute
                            </span>
                            <span class="font-semibold text-slate-900" th:text="${wildcard.namespaceDisplayName}">Namespace</span>
                            <!-- Cardinality badge for xs:any -->
                            <span th:if="${wildcard.type.name() == 'ANY' and wildcard.cardinality != null}"
                                  class="inline-flex items-center px-2.5 py-0.5 rounded-md text-xs font-mono bg-slate-100 text-slate-700 border border-slate-300"
                                  th:text="${wildcard.cardinality}">[1..*]</span>
                        </div>

                        <dl class="grid grid-cols-1 gap-4 text-sm">
                            <!-- Namespace -->
                            <div class="space-y-2">
                                <dt class="font-semibold text-teal-900 uppercase text-xs tracking-wide">Namespace</dt>
                                <dd class="font-mono text-sm text-slate-900 bg-white px-4 py-3 rounded-md border border-teal-300 shadow-sm"
                                    th:text="${wildcard.namespace}">##any</dd>
                            </div>

                            <!-- Process Contents -->
                            <div th:if="${wildcard.processContents != null}" class="space-y-2">
                                <dt class="font-semibold text-teal-900 uppercase text-xs tracking-wide">Process Contents</dt>
                                <dd class="text-sm text-slate-900 bg-white px-4 py-3 rounded-md border border-teal-300 shadow-sm">
                                    <span class="font-semibold" th:text="${wildcard.processContents.name()}">STRICT</span>
                                    <span class="text-slate-600 ml-2" th:if="${wildcard.processContents.name() == 'STRICT'}">
                                        (Must be valid according to schema)
                                    </span>
                                    <span class="text-slate-600 ml-2" th:if="${wildcard.processContents.name() == 'LAX'}">
                                        (Validate if schema available, otherwise skip)
                                    </span>
                                    <span class="text-slate-600 ml-2" th:if="${wildcard.processContents.name() == 'SKIP'}">
                                        (No validation)
                                    </span>
                                </dd>
                            </div>

                            <!-- Documentation -->
                            <div th:if="${wildcard.documentation != null and not #strings.isEmpty(wildcard.documentation)}" class="space-y-2">
                                <dt class="font-semibold text-teal-900 uppercase text-xs tracking-wide">Documentation</dt>
                                <dd class="text-slate-700 bg-white px-4 py-3 rounded-md border border-teal-300 prose prose-sm max-w-none"
                                    th:text="${wildcard.documentation}">documentation</dd>
                            </div>
                        </dl>
                    </div>
                </div>
            </section>

            <!-- Section: Open Content (XSD 1.1) -->
            <section th:if="${element.openContent != null}">
                <h2 class="text-lg font-semibold text-slate-800 mb-4">Open Content (XSD 1.1)</h2>
                <div class="bg-violet-50 border-2 border-violet-200 rounded-lg p-5 shadow-sm">
                    <div class="flex items-center gap-3 mb-4 pb-3 border-b border-violet-300">
                        <span class="inline-flex items-center px-3 py-1 rounded-md text-xs font-semibold bg-violet-100 text-violet-800 border border-violet-400">
                            Open Content
                        </span>
                        <span class="font-semibold text-slate-900" th:text="${element.openContent.modeDisplayName}">Mode</span>
                    </div>

                    <dl class="grid grid-cols-1 gap-4 text-sm">
                        <!-- Mode -->
                        <div class="space-y-2">
                            <dt class="font-semibold text-violet-900 uppercase text-xs tracking-wide">Mode</dt>
                            <dd class="text-sm text-slate-900 bg-white px-4 py-3 rounded-md border border-violet-300 shadow-sm">
                                <span class="font-semibold" th:text="${element.openContent.mode.name()}">INTERLEAVE</span>
                                <span class="text-slate-600 ml-2" th:if="${element.openContent.mode.name() == 'INTERLEAVE'}">
                                    - Elements can appear anywhere among the explicitly defined elements
                                </span>
                                <span class="text-slate-600 ml-2" th:if="${element.openContent.mode.name() == 'SUFFIX'}">
                                    - Elements can only appear after the explicitly defined elements
                                </span>
                            </dd>
                        </div>

                        <!-- Namespace -->
                        <div th:if="${element.openContent.namespace != null and not #strings.isEmpty(element.openContent.namespace)}" class="space-y-2">
                            <dt class="font-semibold text-violet-900 uppercase text-xs tracking-wide">Namespace</dt>
                            <dd class="font-mono text-sm text-slate-900 bg-white px-4 py-3 rounded-md border border-violet-300 shadow-sm">
                                <span th:text="${element.openContent.namespaceDisplayName}">##any</span>
                            </dd>
                        </div>

                        <!-- Process Contents -->
                        <div th:if="${element.openContent.processContents != null and not #strings.isEmpty(element.openContent.processContents)}" class="space-y-2">
                            <dt class="font-semibold text-violet-900 uppercase text-xs tracking-wide">Process Contents</dt>
                            <dd class="text-sm text-slate-900 bg-white px-4 py-3 rounded-md border border-violet-300 shadow-sm">
                                <span class="font-semibold" th:text="${element.openContent.processContents}">strict</span>
                                <span class="text-slate-600 ml-2" th:if="${element.openContent.processContents == 'strict'}">
                                    - Must be valid according to schema
                                </span>
                                <span class="text-slate-600 ml-2" th:if="${element.openContent.processContents == 'lax'}">
                                    - Validate if schema is available, otherwise skip
                                </span>
                                <span class="text-slate-600 ml-2" th:if="${element.openContent.processContents == 'skip'}">
                                    - No validation
                                </span>
                            </dd>
                        </div>

                        <!-- Documentation -->
                        <div th:if="${element.openContent.documentation != null and not #strings.isEmpty(element.openContent.documentation)}" class="space-y-2">
                            <dt class="font-semibold text-violet-900 uppercase text-xs tracking-wide">Documentation</dt>
                            <dd class="text-slate-700 bg-white px-4 py-3 rounded-md border border-violet-300 prose prose-sm max-w-none"
                                th:text="${element.openContent.documentation}">documentation</dd>
                        </div>
                    </dl>
                </div>
            </section>

            <!-- Section: Element Definition -->
            <section th:if="${code != null}">
                <details open class="group">
                    <summary class="cursor-pointer select-none list-none">
                        <div class="flex items-center gap-2 p-3 bg-slate-50 rounded-t-lg border border-slate-200 hover:bg-slate-100 transition-colors">
                            <svg class="w-5 h-5 text-slate-600 transition-transform rotate-90 group-open:rotate-0"
                                 fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                            </svg>
                            <h2 class="text-lg font-semibold text-slate-800">Element Definition</h2>
                        </div>
                    </summary>
                    <div class="rounded-b-lg overflow-hidden border border-t-0 border-slate-200">
                        <pre class="language-xml !m-0"><code th:text="${code}">... code ...</code></pre>
                    </div>
                </details>
            </section>

            <!-- Section: Referenced Type Definition -->
            <section th:if="${referencedTypeCode != null}">
                <details open class="group">
                    <summary class="cursor-pointer select-none list-none">
                        <div class="flex items-center gap-2 p-3 bg-slate-50 rounded-t-lg border border-slate-200 hover:bg-slate-100 transition-colors">
                            <svg class="w-5 h-5 text-slate-600 transition-transform rotate-90 group-open:rotate-0"
                                 fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                            </svg>
                            <h2 class="text-lg font-semibold text-slate-800">Referenced Type Definition
                                <span class="font-mono text-sm text-slate-600" th:if="${referencedTypeName != null}">
                                    (<span th:text="${referencedTypeName}">TypeName</span>)
                                </span>
                            </h2>
                        </div>
                    </summary>
                    <div class="rounded-b-lg overflow-hidden border border-t-0 border-slate-200">
                        <pre class="language-xml !m-0"><code th:text="${referencedTypeCode}">... type code ...</code></pre>
                    </div>
                </details>
            </section>

        </div>
    </div>
</main>

<!-- Load scripts at the end -->
<script src="../assets/prism.js"></script>
<script src="../assets/search.js" defer></script>
<script src="../assets/language-switcher.js" defer></script>

<!-- JavaScript for the copy functionality -->
<script>
    function copyXPath(buttonElement) {
        const textToCopy = buttonElement.getAttribute('data-xpath');
        const tooltip = buttonElement.querySelector('.tooltip-text');

        navigator.clipboard.writeText(textToCopy).then(() => {
            tooltip.textContent = 'Copied!';
            setTimeout(() => {
                tooltip.textContent = 'Copy XPath';
            }, 2000);
        }).catch(err => {
            tooltip.textContent = 'Failed to copy!';
            console.error('Could not copy text: ', err);
            setTimeout(() => {
                tooltip.textContent = 'Copy XPath';
            }, 2000);
        });
    }

    function copyPermalink(buttonElement) {
        const xpath = buttonElement.getAttribute('data-xpath');
        const tooltip = buttonElement.querySelector('.tooltip-text');

        const permalinkUrl = new URL('../index.html', window.location.href);
        permalinkUrl.searchParams.set('xpath', xpath);

        const urlToCopy = permalinkUrl.href.replaceAll('%2F', '/');

        navigator.clipboard.writeText(urlToCopy).then(() => {
            tooltip.textContent = 'Copied!';
            setTimeout(() => {
                tooltip.textContent = 'Copy Permalink';
            }, 2000);
        }).catch(err => {
            tooltip.textContent = 'Failed to copy!';
            console.error('Could not copy permalink: ', err);
            setTimeout(() => {
                tooltip.textContent = 'Copy Permalink';
            }, 2000);
        });
    }
</script>

</body>
</html>